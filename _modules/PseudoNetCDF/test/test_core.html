

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../../">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>PseudoNetCDF.test.test_core &mdash; PseudoNetCDF 3.4.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=03e43079" />
      <link rel="stylesheet" type="text/css" href="../../../_static/css/theme.css?v=e59714d7" />

  
      <script src="../../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../../_static/documentation_options.js?v=149be4c9"></script>
      <script src="../../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../index.html" class="icon icon-home">
            PseudoNetCDF
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Table of Contents</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../index.html">PseudoNetCDF Userâ€™s Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../quick.html">Quick Start</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../examples.html">Example Use Cases</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../readers.html">Formats</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../installing.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../core.html">Core Objects</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/PseudoNetCDF.html">PseudoNetCDF package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../issues.html">Get in touch</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">PseudoNetCDF</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../index.html">Module code</a></li>
          <li class="breadcrumb-item"><a href="../test.html">PseudoNetCDF.test</a></li>
      <li class="breadcrumb-item active">PseudoNetCDF.test.test_core</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for PseudoNetCDF.test.test_core</h1><div class="highlight"><pre>
<span></span><span class="kn">import</span><span class="w"> </span><span class="nn">unittest</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">PseudoNetCDF</span><span class="w"> </span><span class="kn">import</span> <span class="n">PseudoNetCDFFile</span><span class="p">,</span> <span class="n">PseudoNetCDFVariables</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">PseudoNetCDF</span><span class="w"> </span><span class="kn">import</span> <span class="n">PseudoNetCDFVariable</span><span class="p">,</span> <span class="n">pncopen</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">.</span><span class="w"> </span><span class="kn">import</span> <span class="n">requires_basemap</span><span class="p">,</span> <span class="n">requires_pyproj</span><span class="p">,</span> <span class="n">requires_matplotlib</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">.</span><span class="w"> </span><span class="kn">import</span> <span class="n">compare_files</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">PseudoNetCDF.pncwarn</span><span class="w"> </span><span class="kn">import</span> <span class="n">warn</span>


<span class="n">np_all_close</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">testing</span><span class="o">.</span><span class="n">assert_allclose</span>


<div class="viewcode-block" id="PseudoNetCDFVariableTest">
<a class="viewcode-back" href="../../../api/PseudoNetCDF.test.html#PseudoNetCDF.test.test_core.PseudoNetCDFVariableTest">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">PseudoNetCDFVariableTest</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>
<div class="viewcode-block" id="PseudoNetCDFVariableTest.setUp">
<a class="viewcode-back" href="../../../api/PseudoNetCDF.test.html#PseudoNetCDF.test.test_core.PseudoNetCDFVariableTest.setUp">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">setUp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">myarray</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
            <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
            <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
            <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
            <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
            <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
        <span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;f&#39;</span><span class="p">)</span></div>


<div class="viewcode-block" id="PseudoNetCDFVariableTest.testVar">
<a class="viewcode-back" href="../../../api/PseudoNetCDF.test.html#PseudoNetCDF.test.test_core.PseudoNetCDFVariableTest.testVar">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">testVar</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">var</span> <span class="o">=</span> <span class="n">PseudoNetCDFVariable</span><span class="p">(</span>
            <span class="kc">None</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">myarray</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">),</span>
            <span class="n">values</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">myarray</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;unknown&#39;</span><span class="p">,</span>
            <span class="n">long_name</span><span class="o">=</span><span class="s1">&#39;unknown&#39;</span>
        <span class="p">)</span>
        <span class="k">assert</span> <span class="p">(</span>
            <span class="n">var</span><span class="o">.</span><span class="n">getncatts</span><span class="p">()</span> <span class="o">==</span> <span class="p">{</span>
                <span class="s1">&#39;units&#39;</span><span class="p">:</span> <span class="s1">&#39;unknown&#39;</span><span class="p">,</span> <span class="s1">&#39;long_name&#39;</span><span class="p">:</span> <span class="s1">&#39;unknown&#39;</span><span class="p">,</span>
            <span class="p">}</span>
        <span class="p">)</span>
        <span class="k">assert</span> <span class="p">(</span><span class="n">var</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">char</span> <span class="o">==</span> <span class="s1">&#39;f&#39;</span><span class="p">)</span>
        <span class="k">assert</span> <span class="p">(</span><span class="n">var</span><span class="o">.</span><span class="n">dimensions</span> <span class="o">==</span> <span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">))</span>
        <span class="n">np_all_close</span><span class="p">(</span><span class="n">var</span><span class="p">[:],</span> <span class="bp">self</span><span class="o">.</span><span class="n">myarray</span><span class="p">)</span></div>


<div class="viewcode-block" id="PseudoNetCDFVariableTest.testFromArray">
<a class="viewcode-back" href="../../../api/PseudoNetCDF.test.html#PseudoNetCDF.test.test_core.PseudoNetCDFVariableTest.testFromArray">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">testFromArray</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">var</span> <span class="o">=</span> <span class="n">PseudoNetCDFVariable</span><span class="o">.</span><span class="n">from_array</span><span class="p">(</span>
            <span class="s1">&#39;unknown&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">myarray</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">),</span>
            <span class="n">units</span><span class="o">=</span><span class="s1">&#39;unknown&#39;</span><span class="p">,</span> <span class="n">long_name</span><span class="o">=</span><span class="s1">&#39;unknown&#39;</span>
        <span class="p">)</span>
        <span class="k">assert</span> <span class="p">(</span>
            <span class="n">var</span><span class="o">.</span><span class="n">getncatts</span><span class="p">()</span> <span class="o">==</span> <span class="p">{</span>
                <span class="s1">&#39;units&#39;</span><span class="p">:</span> <span class="s1">&#39;unknown&#39;</span><span class="p">,</span> <span class="s1">&#39;long_name&#39;</span><span class="p">:</span> <span class="s1">&#39;unknown&#39;</span><span class="p">,</span>
            <span class="p">}</span>
        <span class="p">)</span>
        <span class="k">assert</span> <span class="p">(</span><span class="n">var</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">char</span> <span class="o">==</span> <span class="s1">&#39;f&#39;</span><span class="p">)</span>
        <span class="k">assert</span> <span class="p">(</span><span class="n">var</span><span class="o">.</span><span class="n">dimensions</span> <span class="o">==</span> <span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">))</span>
        <span class="n">np_all_close</span><span class="p">(</span><span class="n">var</span><span class="p">[:],</span> <span class="bp">self</span><span class="o">.</span><span class="n">myarray</span><span class="p">)</span></div>
</div>



<div class="viewcode-block" id="PseudoNetCDFFileTest">
<a class="viewcode-back" href="../../../api/PseudoNetCDF.test.html#PseudoNetCDF.test.test_core.PseudoNetCDFFileTest">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">PseudoNetCDFFileTest</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>
<div class="viewcode-block" id="PseudoNetCDFFileTest.setUp">
<a class="viewcode-back" href="../../../api/PseudoNetCDF.test.html#PseudoNetCDF.test.test_core.PseudoNetCDFFileTest.setUp">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">setUp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="kn">import</span> <span class="n">datetime</span><span class="p">,</span> <span class="n">timedelta</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">testncf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_makencf</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mymeta</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([</span>
            <span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="s1">&#39;time_bounds&#39;</span><span class="p">,</span> <span class="s1">&#39;latitude&#39;</span><span class="p">,</span> <span class="s1">&#39;longitude&#39;</span><span class="p">,</span> <span class="s1">&#39;latitude_bounds&#39;</span><span class="p">,</span>
            <span class="s1">&#39;longitude_bounds&#39;</span><span class="p">,</span> <span class="s1">&#39;lambert_conformal_conic&#39;</span>
        <span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">myvars</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mymeta</span><span class="o">.</span><span class="n">union</span><span class="p">([</span><span class="s1">&#39;O3&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mydims</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;TIME&#39;</span><span class="p">,</span> <span class="s1">&#39;LAY&#39;</span><span class="p">,</span> <span class="s1">&#39;ROW&#39;</span><span class="p">,</span> <span class="s1">&#39;COL&#39;</span><span class="p">,</span> <span class="s1">&#39;nv&#39;</span><span class="p">,</span> <span class="s1">&#39;tnv&#39;</span><span class="p">]</span>
        <span class="n">rtime</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span>
            <span class="s1">&#39;1970-01-01 00:00:00+0000&#39;</span><span class="p">,</span> <span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1"> %H:%M:%S%z&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mytimes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">rtime</span> <span class="o">+</span> <span class="n">timedelta</span><span class="p">(</span><span class="n">hours</span><span class="o">=</span><span class="n">i</span><span class="p">)</span>
                                 <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">24</span><span class="p">)])</span></div>


    <span class="k">def</span><span class="w"> </span><span class="nf">_makencf</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="kn">import</span> <span class="n">arange</span>
        <span class="n">tncf</span> <span class="o">=</span> <span class="n">PseudoNetCDFFile</span><span class="p">()</span>

        <span class="n">tncf</span><span class="o">.</span><span class="n">createDimension</span><span class="p">(</span><span class="s1">&#39;TSTEP&#39;</span><span class="p">,</span> <span class="mi">24</span><span class="p">)</span>
        <span class="n">tncf</span><span class="o">.</span><span class="n">createDimension</span><span class="p">(</span><span class="s1">&#39;LAY&#39;</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
        <span class="n">tncf</span><span class="o">.</span><span class="n">createDimension</span><span class="p">(</span><span class="s1">&#39;ROW&#39;</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
        <span class="n">tncf</span><span class="o">.</span><span class="n">createDimension</span><span class="p">(</span><span class="s1">&#39;COL&#39;</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
        <span class="n">tncf</span><span class="o">.</span><span class="n">createDimension</span><span class="p">(</span><span class="s1">&#39;nv&#39;</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
        <span class="n">tncf</span><span class="o">.</span><span class="n">createDimension</span><span class="p">(</span><span class="s1">&#39;tnv&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">tncf</span><span class="o">.</span><span class="n">str_one</span> <span class="o">=</span> <span class="s1">&#39;1&#39;</span>
        <span class="n">tncf</span><span class="o">.</span><span class="n">int_two</span> <span class="o">=</span> <span class="mi">2</span>
        <span class="n">tncf</span><span class="o">.</span><span class="n">float_threeptfive</span> <span class="o">=</span> <span class="mf">3.5</span>
        <span class="n">tncf</span><span class="o">.</span><span class="n">Conventions</span> <span class="o">=</span> <span class="s1">&#39;CF-1.6&#39;</span>
        <span class="n">o3</span> <span class="o">=</span> <span class="n">tncf</span><span class="o">.</span><span class="n">createVariable</span><span class="p">(</span><span class="s1">&#39;O3&#39;</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;TSTEP&#39;</span><span class="p">,</span> <span class="s1">&#39;LAY&#39;</span><span class="p">,</span> <span class="s1">&#39;ROW&#39;</span><span class="p">,</span> <span class="s1">&#39;COL&#39;</span><span class="p">))</span>

        <span class="n">o3</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">arange</span><span class="p">(</span><span class="mi">24</span> <span class="o">*</span> <span class="mi">4</span> <span class="o">*</span> <span class="mi">5</span> <span class="o">*</span> <span class="mi">6</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">24</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
        <span class="n">o3</span><span class="o">.</span><span class="n">units</span> <span class="o">=</span> <span class="s1">&#39;ppbv&#39;</span>
        <span class="n">o3</span><span class="o">.</span><span class="n">grid_mapping</span> <span class="o">=</span> <span class="s1">&#39;lambert_conformal_conic&#39;</span>
        <span class="n">time</span> <span class="o">=</span> <span class="n">tncf</span><span class="o">.</span><span class="n">createVariable</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;TSTEP&#39;</span><span class="p">,))</span>
        <span class="n">time</span><span class="o">.</span><span class="n">long_name</span> <span class="o">=</span> <span class="s1">&#39;time&#39;</span>
        <span class="n">time</span><span class="o">.</span><span class="n">units</span> <span class="o">=</span> <span class="s1">&#39;hours since 1970-01-01 00:00:00+0000&#39;</span>
        <span class="n">time</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">24</span><span class="p">)</span>

        <span class="n">timeb</span> <span class="o">=</span> <span class="n">tncf</span><span class="o">.</span><span class="n">createVariable</span><span class="p">(</span><span class="s1">&#39;time_bounds&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;TSTEP&#39;</span><span class="p">,</span> <span class="s1">&#39;tnv&#39;</span><span class="p">))</span>
        <span class="n">timeb</span><span class="o">.</span><span class="n">long_name</span> <span class="o">=</span> <span class="s1">&#39;time_bounds&#39;</span>
        <span class="n">timeb</span><span class="o">.</span><span class="n">units</span> <span class="o">=</span> <span class="s1">&#39;hours since 1970-01-01 00:00:00+0000&#39;</span>
        <span class="n">timeb</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">24</span><span class="p">)</span>
        <span class="n">timeb</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">25</span><span class="p">)</span>

        <span class="n">crs</span> <span class="o">=</span> <span class="n">tncf</span><span class="o">.</span><span class="n">createVariable</span><span class="p">(</span><span class="s1">&#39;lambert_conformal_conic&#39;</span><span class="p">,</span> <span class="s1">&#39;i&#39;</span><span class="p">,</span> <span class="p">())</span>
        <span class="n">crs</span><span class="o">.</span><span class="n">grid_mapping_name</span> <span class="o">=</span> <span class="s1">&#39;lambert_conformal_conic&#39;</span>
        <span class="n">crs</span><span class="o">.</span><span class="n">standard_parallel</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">30.</span><span class="p">,</span> <span class="mf">45.</span><span class="p">])</span>
        <span class="n">crs</span><span class="o">.</span><span class="n">longitude_of_central_meridian</span> <span class="o">=</span> <span class="o">-</span><span class="mf">97.</span>
        <span class="n">crs</span><span class="o">.</span><span class="n">latitude_of_projection_origin</span> <span class="o">=</span> <span class="mf">40.</span>
        <span class="n">crs</span><span class="o">.</span><span class="n">false_northing</span> <span class="o">=</span> <span class="mf">1620000.</span>
        <span class="n">crs</span><span class="o">.</span><span class="n">false_easting</span> <span class="o">=</span> <span class="mf">2412000.</span>
        <span class="n">crs</span><span class="o">.</span><span class="n">semi_major_axis</span> <span class="o">=</span> <span class="mf">6371000.</span>
        <span class="n">crs</span><span class="o">.</span><span class="n">semi_minor_axis</span> <span class="o">=</span> <span class="mf">6371000.</span>
        <span class="n">lat</span> <span class="o">=</span> <span class="n">tncf</span><span class="o">.</span><span class="n">createVariable</span><span class="p">(</span><span class="s1">&#39;latitude&#39;</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;ROW&#39;</span><span class="p">,</span> <span class="s1">&#39;COL&#39;</span><span class="p">))</span>
        <span class="n">lat</span><span class="o">.</span><span class="n">long_name</span> <span class="o">=</span> <span class="s1">&#39;latitude&#39;</span>
        <span class="n">lat</span><span class="o">.</span><span class="n">units</span> <span class="o">=</span> <span class="s1">&#39;degrees_north&#39;</span>
        <span class="n">lon</span> <span class="o">=</span> <span class="n">tncf</span><span class="o">.</span><span class="n">createVariable</span><span class="p">(</span><span class="s1">&#39;longitude&#39;</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;ROW&#39;</span><span class="p">,</span> <span class="s1">&#39;COL&#39;</span><span class="p">))</span>
        <span class="n">lon</span><span class="o">.</span><span class="n">long_name</span> <span class="o">=</span> <span class="s1">&#39;longitude&#39;</span>
        <span class="n">lon</span><span class="o">.</span><span class="n">units</span> <span class="o">=</span> <span class="s1">&#39;degrees_east&#39;</span>
        <span class="n">latb</span> <span class="o">=</span> <span class="n">tncf</span><span class="o">.</span><span class="n">createVariable</span><span class="p">(</span>
            <span class="s1">&#39;latitude_bounds&#39;</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;ROW&#39;</span><span class="p">,</span> <span class="s1">&#39;COL&#39;</span><span class="p">,</span> <span class="s1">&#39;nv&#39;</span><span class="p">))</span>
        <span class="n">latb</span><span class="o">.</span><span class="n">long_name</span> <span class="o">=</span> <span class="s1">&#39;latitude_bounds&#39;</span>
        <span class="n">latb</span><span class="o">.</span><span class="n">units</span> <span class="o">=</span> <span class="s1">&#39;degrees_north&#39;</span>
        <span class="n">lonb</span> <span class="o">=</span> <span class="n">tncf</span><span class="o">.</span><span class="n">createVariable</span><span class="p">(</span>
            <span class="s1">&#39;longitude_bounds&#39;</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;ROW&#39;</span><span class="p">,</span> <span class="s1">&#39;COL&#39;</span><span class="p">,</span> <span class="s1">&#39;nv&#39;</span><span class="p">))</span>
        <span class="n">lonb</span><span class="o">.</span><span class="n">long_name</span> <span class="o">=</span> <span class="s1">&#39;longitude_bounds&#39;</span>
        <span class="n">lonb</span><span class="o">.</span><span class="n">units</span> <span class="o">=</span> <span class="s1">&#39;degrees_east&#39;</span>
        <span class="n">lon</span><span class="p">[:]</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">[</span><span class="o">-</span><span class="mf">120.21161038333193</span><span class="p">,</span> <span class="o">-</span><span class="mf">120.21160114763147</span><span class="p">,</span> <span class="o">-</span><span class="mf">120.21159191193058</span><span class="p">,</span>
             <span class="o">-</span><span class="mf">120.21158267622918</span><span class="p">,</span> <span class="o">-</span><span class="mf">120.21157344052737</span><span class="p">,</span> <span class="o">-</span><span class="mf">120.21156420482505</span><span class="p">],</span>
            <span class="p">[</span><span class="o">-</span><span class="mf">120.21161271536134</span><span class="p">,</span> <span class="o">-</span><span class="mf">120.21160347966001</span><span class="p">,</span> <span class="o">-</span><span class="mf">120.21159424395826</span><span class="p">,</span>
             <span class="o">-</span><span class="mf">120.21158500825604</span><span class="p">,</span> <span class="o">-</span><span class="mf">120.21157577255335</span><span class="p">,</span> <span class="o">-</span><span class="mf">120.21156653685021</span><span class="p">],</span>
            <span class="p">[</span><span class="o">-</span><span class="mf">120.21161504739118</span><span class="p">,</span> <span class="o">-</span><span class="mf">120.21160581168901</span><span class="p">,</span> <span class="o">-</span><span class="mf">120.21159657598642</span><span class="p">,</span>
             <span class="o">-</span><span class="mf">120.21158734028334</span><span class="p">,</span> <span class="o">-</span><span class="mf">120.2115781045798</span><span class="p">,</span> <span class="o">-</span><span class="mf">120.2115688688758</span><span class="p">],</span>
            <span class="p">[</span><span class="o">-</span><span class="mf">120.21161737942151</span><span class="p">,</span> <span class="o">-</span><span class="mf">120.21160814371851</span><span class="p">,</span> <span class="o">-</span><span class="mf">120.21159890801503</span><span class="p">,</span>
             <span class="o">-</span><span class="mf">120.21158967231109</span><span class="p">,</span> <span class="o">-</span><span class="mf">120.21158043660672</span><span class="p">,</span> <span class="o">-</span><span class="mf">120.21157120090189</span><span class="p">],</span>
            <span class="p">[</span><span class="o">-</span><span class="mf">120.21161971145229</span><span class="p">,</span> <span class="o">-</span><span class="mf">120.21161047574842</span><span class="p">,</span> <span class="o">-</span><span class="mf">120.21160124004409</span><span class="p">,</span>
             <span class="o">-</span><span class="mf">120.21159200433934</span><span class="p">,</span> <span class="o">-</span><span class="mf">120.21158276863409</span><span class="p">,</span> <span class="o">-</span><span class="mf">120.21157353292838</span><span class="p">]]</span>

        <span class="n">lat</span><span class="p">[:]</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">[</span><span class="mf">22.748507533242535</span><span class="p">,</span> <span class="mf">22.748509683865187</span><span class="p">,</span> <span class="mf">22.74851183448702</span><span class="p">,</span>
             <span class="mf">22.74851398510802</span><span class="p">,</span> <span class="mf">22.748516135728206</span><span class="p">,</span> <span class="mf">22.748518286347593</span><span class="p">],</span>
            <span class="p">[</span><span class="mf">22.74851605050742</span><span class="p">,</span> <span class="mf">22.748518201130356</span><span class="p">,</span> <span class="mf">22.748520351752475</span><span class="p">,</span>
             <span class="mf">22.74852250237377</span><span class="p">,</span> <span class="mf">22.74852465299425</span><span class="p">,</span> <span class="mf">22.748526803613903</span><span class="p">],</span>
            <span class="p">[</span><span class="mf">22.74852456777256</span><span class="p">,</span> <span class="mf">22.748526718395773</span><span class="p">,</span> <span class="mf">22.748528869018187</span><span class="p">,</span>
             <span class="mf">22.748531019639763</span><span class="p">,</span> <span class="mf">22.748533170260536</span><span class="p">,</span> <span class="mf">22.74853532088048</span><span class="p">],</span>
            <span class="p">[</span><span class="mf">22.748533085037966</span><span class="p">,</span> <span class="mf">22.74853523566145</span><span class="p">,</span> <span class="mf">22.74853738628417</span><span class="p">,</span>
             <span class="mf">22.748539536906023</span><span class="p">,</span> <span class="mf">22.7485416875271</span><span class="p">,</span> <span class="mf">22.748543838147327</span><span class="p">],</span>
            <span class="p">[</span><span class="mf">22.74854160230359</span><span class="p">,</span> <span class="mf">22.74854375292739</span><span class="p">,</span> <span class="mf">22.748545903550376</span><span class="p">,</span>
             <span class="mf">22.748548054172538</span><span class="p">,</span> <span class="mf">22.748550204793883</span><span class="p">,</span> <span class="mf">22.7485523554144</span><span class="p">]]</span>
        <span class="n">lonb</span><span class="p">[:]</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">[[</span><span class="o">-</span><span class="mf">120.21161038333193</span><span class="p">,</span> <span class="o">-</span><span class="mf">120.21160114763147</span><span class="p">,</span>
              <span class="o">-</span><span class="mf">120.21160347966001</span><span class="p">,</span> <span class="o">-</span><span class="mf">120.21161271536134</span><span class="p">],</span>
             <span class="p">[</span><span class="o">-</span><span class="mf">120.21160114763147</span><span class="p">,</span> <span class="o">-</span><span class="mf">120.21159191193058</span><span class="p">,</span>
              <span class="o">-</span><span class="mf">120.21159424395826</span><span class="p">,</span> <span class="o">-</span><span class="mf">120.21160347966001</span><span class="p">],</span>
             <span class="p">[</span><span class="o">-</span><span class="mf">120.21159191193058</span><span class="p">,</span> <span class="o">-</span><span class="mf">120.21158267622918</span><span class="p">,</span>
              <span class="o">-</span><span class="mf">120.21158500825604</span><span class="p">,</span> <span class="o">-</span><span class="mf">120.21159424395826</span><span class="p">],</span>
             <span class="p">[</span><span class="o">-</span><span class="mf">120.21158267622918</span><span class="p">,</span> <span class="o">-</span><span class="mf">120.21157344052737</span><span class="p">,</span>
              <span class="o">-</span><span class="mf">120.21157577255335</span><span class="p">,</span> <span class="o">-</span><span class="mf">120.21158500825604</span><span class="p">],</span>
             <span class="p">[</span><span class="o">-</span><span class="mf">120.21157344052737</span><span class="p">,</span> <span class="o">-</span><span class="mf">120.21156420482505</span><span class="p">,</span>
              <span class="o">-</span><span class="mf">120.21156653685021</span><span class="p">,</span> <span class="o">-</span><span class="mf">120.21157577255335</span><span class="p">],</span>
             <span class="p">[</span><span class="o">-</span><span class="mf">120.21156420482505</span><span class="p">,</span> <span class="o">-</span><span class="mf">120.2115549691223</span><span class="p">,</span>
              <span class="o">-</span><span class="mf">120.2115573011466</span><span class="p">,</span> <span class="o">-</span><span class="mf">120.21156653685021</span><span class="p">]],</span>
            <span class="p">[[</span><span class="o">-</span><span class="mf">120.21161271536134</span><span class="p">,</span> <span class="o">-</span><span class="mf">120.21160347966001</span><span class="p">,</span>
              <span class="o">-</span><span class="mf">120.21160581168901</span><span class="p">,</span> <span class="o">-</span><span class="mf">120.21161504739118</span><span class="p">],</span>
             <span class="p">[</span><span class="o">-</span><span class="mf">120.21160347966001</span><span class="p">,</span> <span class="o">-</span><span class="mf">120.21159424395826</span><span class="p">,</span>
              <span class="o">-</span><span class="mf">120.21159657598642</span><span class="p">,</span> <span class="o">-</span><span class="mf">120.21160581168901</span><span class="p">],</span>
             <span class="p">[</span><span class="o">-</span><span class="mf">120.21159424395826</span><span class="p">,</span> <span class="o">-</span><span class="mf">120.21158500825604</span><span class="p">,</span>
              <span class="o">-</span><span class="mf">120.21158734028334</span><span class="p">,</span> <span class="o">-</span><span class="mf">120.21159657598642</span><span class="p">],</span>
             <span class="p">[</span><span class="o">-</span><span class="mf">120.21158500825604</span><span class="p">,</span> <span class="o">-</span><span class="mf">120.21157577255335</span><span class="p">,</span>
              <span class="o">-</span><span class="mf">120.2115781045798</span><span class="p">,</span> <span class="o">-</span><span class="mf">120.21158734028334</span><span class="p">],</span>
             <span class="p">[</span><span class="o">-</span><span class="mf">120.21157577255335</span><span class="p">,</span> <span class="o">-</span><span class="mf">120.21156653685021</span><span class="p">,</span>
              <span class="o">-</span><span class="mf">120.2115688688758</span><span class="p">,</span> <span class="o">-</span><span class="mf">120.2115781045798</span><span class="p">],</span>
             <span class="p">[</span><span class="o">-</span><span class="mf">120.21156653685021</span><span class="p">,</span> <span class="o">-</span><span class="mf">120.2115573011466</span><span class="p">,</span>
              <span class="o">-</span><span class="mf">120.21155963317135</span><span class="p">,</span> <span class="o">-</span><span class="mf">120.2115688688758</span><span class="p">]],</span>
            <span class="p">[[</span><span class="o">-</span><span class="mf">120.21161504739118</span><span class="p">,</span> <span class="o">-</span><span class="mf">120.21160581168901</span><span class="p">,</span>
              <span class="o">-</span><span class="mf">120.21160814371851</span><span class="p">,</span> <span class="o">-</span><span class="mf">120.21161737942151</span><span class="p">],</span>
             <span class="p">[</span><span class="o">-</span><span class="mf">120.21160581168901</span><span class="p">,</span> <span class="o">-</span><span class="mf">120.21159657598642</span><span class="p">,</span>
              <span class="o">-</span><span class="mf">120.21159890801503</span><span class="p">,</span> <span class="o">-</span><span class="mf">120.21160814371851</span><span class="p">],</span>
             <span class="p">[</span><span class="o">-</span><span class="mf">120.21159657598642</span><span class="p">,</span> <span class="o">-</span><span class="mf">120.21158734028334</span><span class="p">,</span>
              <span class="o">-</span><span class="mf">120.21158967231109</span><span class="p">,</span> <span class="o">-</span><span class="mf">120.21159890801503</span><span class="p">],</span>
             <span class="p">[</span><span class="o">-</span><span class="mf">120.21158734028334</span><span class="p">,</span> <span class="o">-</span><span class="mf">120.2115781045798</span><span class="p">,</span>
              <span class="o">-</span><span class="mf">120.21158043660672</span><span class="p">,</span> <span class="o">-</span><span class="mf">120.21158967231109</span><span class="p">],</span>
             <span class="p">[</span><span class="o">-</span><span class="mf">120.2115781045798</span><span class="p">,</span> <span class="o">-</span><span class="mf">120.2115688688758</span><span class="p">,</span>
              <span class="o">-</span><span class="mf">120.21157120090189</span><span class="p">,</span> <span class="o">-</span><span class="mf">120.21158043660672</span><span class="p">],</span>
             <span class="p">[</span><span class="o">-</span><span class="mf">120.2115688688758</span><span class="p">,</span> <span class="o">-</span><span class="mf">120.21155963317135</span><span class="p">,</span>
              <span class="o">-</span><span class="mf">120.21156196519657</span><span class="p">,</span> <span class="o">-</span><span class="mf">120.21157120090189</span><span class="p">]],</span>
            <span class="p">[[</span><span class="o">-</span><span class="mf">120.21161737942151</span><span class="p">,</span> <span class="o">-</span><span class="mf">120.21160814371851</span><span class="p">,</span>
              <span class="o">-</span><span class="mf">120.21161047574842</span><span class="p">,</span> <span class="o">-</span><span class="mf">120.21161971145229</span><span class="p">],</span>
             <span class="p">[</span><span class="o">-</span><span class="mf">120.21160814371851</span><span class="p">,</span> <span class="o">-</span><span class="mf">120.21159890801503</span><span class="p">,</span>
              <span class="o">-</span><span class="mf">120.21160124004409</span><span class="p">,</span> <span class="o">-</span><span class="mf">120.21161047574842</span><span class="p">],</span>
             <span class="p">[</span><span class="o">-</span><span class="mf">120.21159890801503</span><span class="p">,</span> <span class="o">-</span><span class="mf">120.21158967231109</span><span class="p">,</span>
              <span class="o">-</span><span class="mf">120.21159200433934</span><span class="p">,</span> <span class="o">-</span><span class="mf">120.21160124004409</span><span class="p">],</span>
             <span class="p">[</span><span class="o">-</span><span class="mf">120.21158967231109</span><span class="p">,</span> <span class="o">-</span><span class="mf">120.21158043660672</span><span class="p">,</span>
              <span class="o">-</span><span class="mf">120.21158276863409</span><span class="p">,</span> <span class="o">-</span><span class="mf">120.21159200433934</span><span class="p">],</span>
             <span class="p">[</span><span class="o">-</span><span class="mf">120.21158043660672</span><span class="p">,</span> <span class="o">-</span><span class="mf">120.21157120090189</span><span class="p">,</span>
              <span class="o">-</span><span class="mf">120.21157353292838</span><span class="p">,</span> <span class="o">-</span><span class="mf">120.21158276863409</span><span class="p">],</span>
             <span class="p">[</span><span class="o">-</span><span class="mf">120.21157120090189</span><span class="p">,</span> <span class="o">-</span><span class="mf">120.21156196519657</span><span class="p">,</span>
              <span class="o">-</span><span class="mf">120.21156429722222</span><span class="p">,</span> <span class="o">-</span><span class="mf">120.21157353292838</span><span class="p">]],</span>
            <span class="p">[[</span><span class="o">-</span><span class="mf">120.21161971145229</span><span class="p">,</span> <span class="o">-</span><span class="mf">120.21161047574842</span><span class="p">,</span>
              <span class="o">-</span><span class="mf">120.21161280777879</span><span class="p">,</span> <span class="o">-</span><span class="mf">120.2116220434835</span><span class="p">],</span>
             <span class="p">[</span><span class="o">-</span><span class="mf">120.21161047574842</span><span class="p">,</span> <span class="o">-</span><span class="mf">120.21160124004409</span><span class="p">,</span>
              <span class="o">-</span><span class="mf">120.21160357207363</span><span class="p">,</span> <span class="o">-</span><span class="mf">120.21161280777879</span><span class="p">],</span>
             <span class="p">[</span><span class="o">-</span><span class="mf">120.21160124004409</span><span class="p">,</span> <span class="o">-</span><span class="mf">120.21159200433934</span><span class="p">,</span>
              <span class="o">-</span><span class="mf">120.21159433636801</span><span class="p">,</span> <span class="o">-</span><span class="mf">120.21160357207363</span><span class="p">],</span>
             <span class="p">[</span><span class="o">-</span><span class="mf">120.21159200433934</span><span class="p">,</span> <span class="o">-</span><span class="mf">120.21158276863409</span><span class="p">,</span>
              <span class="o">-</span><span class="mf">120.21158510066192</span><span class="p">,</span> <span class="o">-</span><span class="mf">120.21159433636801</span><span class="p">],</span>
             <span class="p">[</span><span class="o">-</span><span class="mf">120.21158276863409</span><span class="p">,</span> <span class="o">-</span><span class="mf">120.21157353292838</span><span class="p">,</span>
              <span class="o">-</span><span class="mf">120.21157586495535</span><span class="p">,</span> <span class="o">-</span><span class="mf">120.21158510066192</span><span class="p">],</span>
             <span class="p">[</span><span class="o">-</span><span class="mf">120.21157353292838</span><span class="p">,</span> <span class="o">-</span><span class="mf">120.21156429722222</span><span class="p">,</span>
              <span class="o">-</span><span class="mf">120.21156662924835</span><span class="p">,</span> <span class="o">-</span><span class="mf">120.21157586495535</span><span class="p">]]]</span>
        <span class="n">latb</span><span class="p">[:]</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">[[</span><span class="mf">22.748507533242535</span><span class="p">,</span> <span class="mf">22.748509683865187</span><span class="p">,</span>
              <span class="mf">22.748518201130356</span><span class="p">,</span> <span class="mf">22.74851605050742</span><span class="p">],</span>
             <span class="p">[</span><span class="mf">22.748509683865187</span><span class="p">,</span> <span class="mf">22.74851183448702</span><span class="p">,</span>
              <span class="mf">22.748520351752475</span><span class="p">,</span> <span class="mf">22.748518201130356</span><span class="p">],</span>
             <span class="p">[</span><span class="mf">22.74851183448702</span><span class="p">,</span> <span class="mf">22.74851398510802</span><span class="p">,</span>
              <span class="mf">22.74852250237377</span><span class="p">,</span> <span class="mf">22.748520351752475</span><span class="p">],</span>
             <span class="p">[</span><span class="mf">22.74851398510802</span><span class="p">,</span> <span class="mf">22.748516135728206</span><span class="p">,</span>
              <span class="mf">22.74852465299425</span><span class="p">,</span> <span class="mf">22.74852250237377</span><span class="p">],</span>
             <span class="p">[</span><span class="mf">22.748516135728206</span><span class="p">,</span> <span class="mf">22.748518286347593</span><span class="p">,</span>
              <span class="mf">22.748526803613903</span><span class="p">,</span> <span class="mf">22.74852465299425</span><span class="p">],</span>
             <span class="p">[</span><span class="mf">22.748518286347593</span><span class="p">,</span> <span class="mf">22.748520436966125</span><span class="p">,</span>
              <span class="mf">22.748528954232754</span><span class="p">,</span> <span class="mf">22.748526803613903</span><span class="p">]],</span>
            <span class="p">[[</span><span class="mf">22.74851605050742</span><span class="p">,</span> <span class="mf">22.748518201130356</span><span class="p">,</span>
              <span class="mf">22.748526718395773</span><span class="p">,</span> <span class="mf">22.74852456777256</span><span class="p">],</span>
             <span class="p">[</span><span class="mf">22.748518201130356</span><span class="p">,</span> <span class="mf">22.748520351752475</span><span class="p">,</span>
              <span class="mf">22.748528869018187</span><span class="p">,</span> <span class="mf">22.748526718395773</span><span class="p">],</span>
             <span class="p">[</span><span class="mf">22.748520351752475</span><span class="p">,</span> <span class="mf">22.74852250237377</span><span class="p">,</span>
              <span class="mf">22.748531019639763</span><span class="p">,</span> <span class="mf">22.748528869018187</span><span class="p">],</span>
             <span class="p">[</span><span class="mf">22.74852250237377</span><span class="p">,</span> <span class="mf">22.74852465299425</span><span class="p">,</span>
              <span class="mf">22.748533170260536</span><span class="p">,</span> <span class="mf">22.748531019639763</span><span class="p">],</span>
             <span class="p">[</span><span class="mf">22.74852465299425</span><span class="p">,</span> <span class="mf">22.748526803613903</span><span class="p">,</span>
              <span class="mf">22.74853532088048</span><span class="p">,</span> <span class="mf">22.748533170260536</span><span class="p">],</span>
             <span class="p">[</span><span class="mf">22.748526803613903</span><span class="p">,</span> <span class="mf">22.748528954232754</span><span class="p">,</span>
              <span class="mf">22.748537471499613</span><span class="p">,</span> <span class="mf">22.74853532088048</span><span class="p">]],</span>
            <span class="p">[[</span><span class="mf">22.74852456777256</span><span class="p">,</span> <span class="mf">22.748526718395773</span><span class="p">,</span>
              <span class="mf">22.74853523566145</span><span class="p">,</span> <span class="mf">22.748533085037966</span><span class="p">],</span>
             <span class="p">[</span><span class="mf">22.748526718395773</span><span class="p">,</span> <span class="mf">22.748528869018187</span><span class="p">,</span>
              <span class="mf">22.74853738628417</span><span class="p">,</span> <span class="mf">22.74853523566145</span><span class="p">],</span>
             <span class="p">[</span><span class="mf">22.748528869018187</span><span class="p">,</span> <span class="mf">22.748531019639763</span><span class="p">,</span>
              <span class="mf">22.748539536906023</span><span class="p">,</span> <span class="mf">22.74853738628417</span><span class="p">],</span>
             <span class="p">[</span><span class="mf">22.748531019639763</span><span class="p">,</span> <span class="mf">22.748533170260536</span><span class="p">,</span>
              <span class="mf">22.7485416875271</span><span class="p">,</span> <span class="mf">22.748539536906023</span><span class="p">],</span>
             <span class="p">[</span><span class="mf">22.748533170260536</span><span class="p">,</span> <span class="mf">22.74853532088048</span><span class="p">,</span>
              <span class="mf">22.748543838147327</span><span class="p">,</span> <span class="mf">22.7485416875271</span><span class="p">],</span>
             <span class="p">[</span><span class="mf">22.74853532088048</span><span class="p">,</span> <span class="mf">22.748537471499613</span><span class="p">,</span>
              <span class="mf">22.748545988766764</span><span class="p">,</span> <span class="mf">22.748543838147327</span><span class="p">]],</span>
            <span class="p">[[</span><span class="mf">22.748533085037966</span><span class="p">,</span> <span class="mf">22.74853523566145</span><span class="p">,</span>
              <span class="mf">22.74854375292739</span><span class="p">,</span> <span class="mf">22.74854160230359</span><span class="p">],</span>
             <span class="p">[</span><span class="mf">22.74853523566145</span><span class="p">,</span> <span class="mf">22.74853738628417</span><span class="p">,</span>
              <span class="mf">22.748545903550376</span><span class="p">,</span> <span class="mf">22.74854375292739</span><span class="p">],</span>
             <span class="p">[</span><span class="mf">22.74853738628417</span><span class="p">,</span> <span class="mf">22.748539536906023</span><span class="p">,</span>
              <span class="mf">22.748548054172538</span><span class="p">,</span> <span class="mf">22.748545903550376</span><span class="p">],</span>
             <span class="p">[</span><span class="mf">22.748539536906023</span><span class="p">,</span> <span class="mf">22.7485416875271</span><span class="p">,</span>
              <span class="mf">22.748550204793883</span><span class="p">,</span> <span class="mf">22.748548054172538</span><span class="p">],</span>
             <span class="p">[</span><span class="mf">22.7485416875271</span><span class="p">,</span> <span class="mf">22.748543838147327</span><span class="p">,</span>
              <span class="mf">22.7485523554144</span><span class="p">,</span> <span class="mf">22.748550204793883</span><span class="p">],</span>
             <span class="p">[</span><span class="mf">22.748543838147327</span><span class="p">,</span> <span class="mf">22.748545988766764</span><span class="p">,</span>
              <span class="mf">22.748554506034104</span><span class="p">,</span> <span class="mf">22.7485523554144</span><span class="p">]],</span>
            <span class="p">[[</span><span class="mf">22.74854160230359</span><span class="p">,</span> <span class="mf">22.74854375292739</span><span class="p">,</span>
              <span class="mf">22.74855227019359</span><span class="p">,</span> <span class="mf">22.748550119569494</span><span class="p">],</span>
             <span class="p">[</span><span class="mf">22.74854375292739</span><span class="p">,</span> <span class="mf">22.748545903550376</span><span class="p">,</span>
              <span class="mf">22.748554420816852</span><span class="p">,</span> <span class="mf">22.74855227019359</span><span class="p">],</span>
             <span class="p">[</span><span class="mf">22.748545903550376</span><span class="p">,</span> <span class="mf">22.748548054172538</span><span class="p">,</span>
              <span class="mf">22.74855657143929</span><span class="p">,</span> <span class="mf">22.748554420816852</span><span class="p">],</span>
             <span class="p">[</span><span class="mf">22.748548054172538</span><span class="p">,</span> <span class="mf">22.748550204793883</span><span class="p">,</span>
              <span class="mf">22.74855872206093</span><span class="p">,</span> <span class="mf">22.74855657143929</span><span class="p">],</span>
             <span class="p">[</span><span class="mf">22.748550204793883</span><span class="p">,</span> <span class="mf">22.7485523554144</span><span class="p">,</span>
              <span class="mf">22.748560872681754</span><span class="p">,</span> <span class="mf">22.74855872206093</span><span class="p">],</span>
             <span class="p">[</span><span class="mf">22.7485523554144</span><span class="p">,</span> <span class="mf">22.748554506034104</span><span class="p">,</span>
              <span class="mf">22.748563023301763</span><span class="p">,</span> <span class="mf">22.748560872681754</span><span class="p">]]]</span>
        <span class="k">return</span> <span class="n">tncf</span>

<div class="viewcode-block" id="PseudoNetCDFFileTest.testVal2idxBounds">
<a class="viewcode-back" href="../../../api/PseudoNetCDF.test.html#PseudoNetCDF.test.test_core.PseudoNetCDFFileTest.testVal2idxBounds">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">testVal2idxBounds</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">lon</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">179.5</span><span class="p">,</span> <span class="mf">179.5</span><span class="p">,</span> <span class="mi">360</span><span class="p">)</span>
        <span class="n">f</span> <span class="o">=</span> <span class="n">PseudoNetCDFFile</span><span class="o">.</span><span class="n">from_arrays</span><span class="p">(</span>
            <span class="n">lon</span><span class="o">=</span><span class="n">lon</span><span class="p">,</span> <span class="n">dims</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;lon&#39;</span><span class="p">,),</span> <span class="n">attrs</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">bounds</span><span class="o">=</span><span class="s1">&#39;lon_bounds&#39;</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">):</span>
            <span class="n">f</span><span class="o">.</span><span class="n">val2idx</span><span class="p">(</span><span class="s1">&#39;lon&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">179.9</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="s1">&#39;error&#39;</span><span class="p">)</span>

        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">):</span>
            <span class="n">f</span><span class="o">.</span><span class="n">val2idx</span><span class="p">(</span><span class="s1">&#39;lon&#39;</span><span class="p">,</span> <span class="mf">179.9</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="s1">&#39;error&#39;</span><span class="p">)</span>

        <span class="n">iidx</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">val2idx</span><span class="p">(</span><span class="s1">&#39;lon&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">179.9</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
        <span class="k">assert</span> <span class="p">(</span><span class="n">iidx</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">createVariable</span><span class="p">(</span>
            <span class="s1">&#39;lon_bounds&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;lon&#39;</span><span class="p">,</span> <span class="s1">&#39;nv&#39;</span><span class="p">),</span>
            <span class="n">values</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">lon</span> <span class="o">-</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">lon</span> <span class="o">+</span> <span class="mf">0.5</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>
        <span class="p">)</span>
        <span class="n">iidx</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">val2idx</span><span class="p">(</span><span class="s1">&#39;lon&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">179.9</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="s1">&#39;error&#39;</span><span class="p">)</span>
        <span class="k">assert</span> <span class="p">(</span><span class="n">iidx</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">createVariable</span><span class="p">(</span>
            <span class="s1">&#39;lon_bounds&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;lonedges&#39;</span><span class="p">),</span> <span class="n">values</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">180</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span> <span class="mi">361</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="n">iidx</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">val2idx</span><span class="p">(</span><span class="s1">&#39;lon&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">179.9</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="s1">&#39;error&#39;</span><span class="p">)</span>
        <span class="k">assert</span> <span class="p">(</span><span class="n">iidx</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span></div>


<div class="viewcode-block" id="PseudoNetCDFFileTest.testVal2idx">
<a class="viewcode-back" href="../../../api/PseudoNetCDF.test.html#PseudoNetCDF.test.test_core.PseudoNetCDFFileTest.testVal2idx">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">testVal2idx</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">ncf</span> <span class="o">=</span> <span class="n">PseudoNetCDFFile</span><span class="p">()</span>
        <span class="n">coorde</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;f&#39;</span><span class="p">)</span>
        <span class="n">coordc</span> <span class="o">=</span> <span class="p">(</span><span class="n">coorde</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">coorde</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span> <span class="o">/</span> <span class="mf">2.</span>
        <span class="n">ncf</span><span class="o">.</span><span class="n">createDimension</span><span class="p">(</span><span class="s1">&#39;coord&#39;</span><span class="p">,</span> <span class="n">coordc</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
        <span class="n">ncf</span><span class="o">.</span><span class="n">createDimension</span><span class="p">(</span><span class="s1">&#39;nv&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">ncf</span><span class="o">.</span><span class="n">createVariable</span><span class="p">(</span>
            <span class="s1">&#39;coord&#39;</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;coord&#39;</span><span class="p">,),</span> <span class="n">values</span><span class="o">=</span><span class="n">coordc</span>
        <span class="p">)</span>
        <span class="n">bncf</span> <span class="o">=</span> <span class="n">ncf</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">bncf</span><span class="o">.</span><span class="n">createVariable</span><span class="p">(</span>
            <span class="s1">&#39;coord_bounds&#39;</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;coord&#39;</span><span class="p">,</span> <span class="s1">&#39;nv&#39;</span><span class="p">),</span>
            <span class="n">values</span><span class="o">=</span><span class="n">coorde</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">)[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="n">bncf</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;coord&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">bounds</span> <span class="o">=</span> <span class="s1">&#39;coord_bounds&#39;</span>
        <span class="n">cvals</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mf">.25</span><span class="p">,</span> <span class="mf">4.5</span><span class="p">,</span> <span class="mf">4.99</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mf">6.75</span><span class="p">,</span> <span class="mi">10</span><span class="p">]</span>
        <span class="n">expectedb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">])</span>
        <span class="n">expectedn</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">])</span>

        <span class="k">def</span><span class="w"> </span><span class="nf">checkvals</span><span class="p">(</span><span class="n">ncf</span><span class="p">,</span> <span class="n">method</span><span class="p">,</span> <span class="n">clean</span><span class="p">,</span> <span class="n">compare</span><span class="p">):</span>
            <span class="n">withbnds</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="s1">&#39;coord_bounds&#39;</span> <span class="ow">in</span> <span class="n">ncf</span><span class="o">.</span><span class="n">variables</span><span class="p">)</span>
            <span class="n">prefix</span> <span class="o">=</span> <span class="n">withbnds</span> <span class="o">+</span> <span class="s1">&#39;&amp;&#39;</span> <span class="o">+</span> <span class="n">method</span> <span class="o">+</span> <span class="s1">&#39;&amp;&#39;</span> <span class="o">+</span> <span class="n">clean</span>
            <span class="n">idx</span> <span class="o">=</span> <span class="n">ncf</span><span class="o">.</span><span class="n">val2idx</span><span class="p">(</span>
                <span class="s1">&#39;coord&#39;</span><span class="p">,</span> <span class="n">cvals</span><span class="p">,</span>
                <span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">,</span> <span class="n">clean</span><span class="o">=</span><span class="n">clean</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="s1">&#39;warn&#39;</span>
            <span class="p">)</span>
            <span class="n">warn</span><span class="p">(</span><span class="n">prefix</span> <span class="o">+</span> <span class="s1">&#39; got: &#39;</span> <span class="o">+</span> <span class="nb">repr</span><span class="p">(</span><span class="n">idx</span><span class="p">))</span>
            <span class="n">warn</span><span class="p">(</span><span class="n">prefix</span> <span class="o">+</span> <span class="s1">&#39; chk: &#39;</span> <span class="o">+</span> <span class="nb">repr</span><span class="p">(</span><span class="n">compare</span><span class="p">))</span>
            <span class="k">assert</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">compare</span><span class="p">,</span> <span class="n">idx</span><span class="p">))</span>

        <span class="n">mw</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">masked_where</span>

        <span class="n">nn_mask</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mi">7</span>
        <span class="n">bn_mask</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mi">7</span>
        <span class="n">nm_mask</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
        <span class="n">bm_mask</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
        <span class="n">em_mask</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
        <span class="n">checkvals</span><span class="p">(</span><span class="n">ncf</span><span class="p">,</span> <span class="s1">&#39;nearest&#39;</span><span class="p">,</span> <span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">mw</span><span class="p">(</span><span class="n">nn_mask</span><span class="p">,</span> <span class="n">expectedn</span><span class="p">))</span>
        <span class="n">checkvals</span><span class="p">(</span><span class="n">ncf</span><span class="p">,</span> <span class="s1">&#39;bounds&#39;</span><span class="p">,</span> <span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">mw</span><span class="p">(</span><span class="n">bn_mask</span><span class="p">,</span> <span class="n">expectedb</span><span class="p">))</span>
        <span class="n">checkvals</span><span class="p">(</span><span class="n">ncf</span><span class="p">,</span> <span class="s1">&#39;nearest&#39;</span><span class="p">,</span> <span class="s1">&#39;mask&#39;</span><span class="p">,</span> <span class="n">mw</span><span class="p">(</span><span class="n">nm_mask</span><span class="p">,</span> <span class="n">expectedn</span><span class="p">))</span>
        <span class="n">checkvals</span><span class="p">(</span><span class="n">ncf</span><span class="p">,</span> <span class="s1">&#39;bounds&#39;</span><span class="p">,</span> <span class="s1">&#39;mask&#39;</span><span class="p">,</span> <span class="n">mw</span><span class="p">(</span><span class="n">bm_mask</span><span class="p">,</span> <span class="n">expectedb</span><span class="p">))</span>

        <span class="n">checkvals</span><span class="p">(</span><span class="n">bncf</span><span class="p">,</span> <span class="s1">&#39;nearest&#39;</span><span class="p">,</span> <span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">mw</span><span class="p">(</span><span class="n">nn_mask</span><span class="p">,</span> <span class="n">expectedn</span><span class="p">))</span>
        <span class="n">checkvals</span><span class="p">(</span><span class="n">bncf</span><span class="p">,</span> <span class="s1">&#39;bounds&#39;</span><span class="p">,</span> <span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">mw</span><span class="p">(</span><span class="n">bn_mask</span><span class="p">,</span> <span class="n">expectedb</span><span class="p">))</span>
        <span class="n">checkvals</span><span class="p">(</span><span class="n">bncf</span><span class="p">,</span> <span class="s1">&#39;nearest&#39;</span><span class="p">,</span> <span class="s1">&#39;mask&#39;</span><span class="p">,</span> <span class="n">mw</span><span class="p">(</span><span class="n">nm_mask</span><span class="p">,</span> <span class="n">expectedn</span><span class="p">))</span>
        <span class="n">checkvals</span><span class="p">(</span><span class="n">bncf</span><span class="p">,</span> <span class="s1">&#39;bounds&#39;</span><span class="p">,</span> <span class="s1">&#39;mask&#39;</span><span class="p">,</span> <span class="n">mw</span><span class="p">(</span><span class="n">bm_mask</span><span class="p">,</span> <span class="n">expectedb</span><span class="p">))</span>

        <span class="n">checkvals</span><span class="p">(</span><span class="n">bncf</span><span class="p">,</span> <span class="s1">&#39;exact&#39;</span><span class="p">,</span> <span class="s1">&#39;mask&#39;</span><span class="p">,</span> <span class="n">mw</span><span class="p">(</span><span class="n">em_mask</span><span class="p">,</span> <span class="n">expectedb</span><span class="p">))</span></div>


<div class="viewcode-block" id="PseudoNetCDFFileTest.testCopyVariable">
<a class="viewcode-back" href="../../../api/PseudoNetCDF.test.html#PseudoNetCDF.test.test_core.PseudoNetCDFFileTest.testCopyVariable">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">testCopyVariable</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">tncf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">testncf</span>
        <span class="n">var</span> <span class="o">=</span> <span class="n">tncf</span><span class="o">.</span><span class="n">copyVariable</span><span class="p">(</span>
            <span class="n">tncf</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;O3&#39;</span><span class="p">],</span> <span class="n">key</span><span class="o">=</span><span class="s1">&#39;O3_PPB&#39;</span><span class="p">,</span> <span class="n">withdata</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="p">(</span><span class="n">var</span><span class="p">[:]</span> <span class="o">==</span> <span class="n">tncf</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;O3_PPB&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">all</span><span class="p">())</span></div>


<div class="viewcode-block" id="PseudoNetCDFFileTest.testSubsetVariables">
<a class="viewcode-back" href="../../../api/PseudoNetCDF.test.html#PseudoNetCDF.test.test_core.PseudoNetCDFFileTest.testSubsetVariables">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">testSubsetVariables</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">tncf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">testncf</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">var</span> <span class="o">=</span> <span class="n">tncf</span><span class="o">.</span><span class="n">copyVariable</span><span class="p">(</span>
            <span class="n">tncf</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;O3&#39;</span><span class="p">],</span> <span class="n">key</span><span class="o">=</span><span class="s1">&#39;O3_PPB&#39;</span><span class="p">,</span> <span class="n">withdata</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">var</span><span class="p">[:]</span> <span class="o">*=</span> <span class="mf">1e3</span>
        <span class="n">var</span> <span class="o">=</span> <span class="n">tncf</span><span class="o">.</span><span class="n">copyVariable</span><span class="p">(</span>
            <span class="n">tncf</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;O3&#39;</span><span class="p">],</span> <span class="n">key</span><span class="o">=</span><span class="s1">&#39;O3_PPT&#39;</span><span class="p">,</span> <span class="n">withdata</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">var</span><span class="p">[:]</span> <span class="o">*=</span> <span class="mf">1e6</span>
        <span class="n">sncf</span> <span class="o">=</span> <span class="n">tncf</span><span class="o">.</span><span class="n">subsetVariables</span><span class="p">([</span><span class="s1">&#39;O3_PPT&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sncf</span><span class="o">.</span><span class="n">variables</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">sncf</span><span class="o">.</span><span class="n">variables</span><span class="p">),</span> <span class="nb">set</span><span class="p">([</span><span class="s1">&#39;O3_PPT&#39;</span><span class="p">]))</span>
        <span class="n">sncf</span> <span class="o">=</span> <span class="n">tncf</span><span class="o">.</span><span class="n">subsetVariables</span><span class="p">([</span><span class="s1">&#39;O3_PPT&#39;</span><span class="p">],</span> <span class="n">exclude</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sncf</span><span class="o">.</span><span class="n">variables</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">myvars</span><span class="o">.</span><span class="n">union</span><span class="p">([</span><span class="s1">&#39;O3_PPB&#39;</span><span class="p">])))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">sncf</span><span class="o">.</span><span class="n">variables</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">myvars</span><span class="o">.</span><span class="n">union</span><span class="p">([</span><span class="s1">&#39;O3_PPB&#39;</span><span class="p">]))</span></div>


<div class="viewcode-block" id="PseudoNetCDFFileTest.testRenameVariables">
<a class="viewcode-back" href="../../../api/PseudoNetCDF.test.html#PseudoNetCDF.test.test_core.PseudoNetCDFFileTest.testRenameVariables">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">testRenameVariables</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">tncf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">testncf</span>
        <span class="n">sncf</span> <span class="o">=</span> <span class="n">tncf</span><span class="o">.</span><span class="n">renameVariables</span><span class="p">(</span><span class="n">O3</span><span class="o">=</span><span class="s1">&#39;O3_PPM&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sncf</span><span class="o">.</span><span class="n">variables</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">myvars</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">sncf</span><span class="o">.</span><span class="n">variables</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">mymeta</span><span class="o">.</span><span class="n">union</span><span class="p">([</span><span class="s1">&#39;O3_PPM&#39;</span><span class="p">]))</span></div>


<div class="viewcode-block" id="PseudoNetCDFFileTest.testRenameDimensions">
<a class="viewcode-back" href="../../../api/PseudoNetCDF.test.html#PseudoNetCDF.test.test_core.PseudoNetCDFFileTest.testRenameDimensions">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">testRenameDimensions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">tncf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">testncf</span>
        <span class="n">sncf</span> <span class="o">=</span> <span class="n">tncf</span><span class="o">.</span><span class="n">renameDimensions</span><span class="p">(</span><span class="n">TSTEP</span><span class="o">=</span><span class="s1">&#39;TIME&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sncf</span><span class="o">.</span><span class="n">dimensions</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">tncf</span><span class="o">.</span><span class="n">dimensions</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">sncf</span><span class="o">.</span><span class="n">dimensions</span><span class="p">),</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mydims</span><span class="p">))</span></div>


<div class="viewcode-block" id="PseudoNetCDFFileTest.testSliceDimensionInt">
<a class="viewcode-back" href="../../../api/PseudoNetCDF.test.html#PseudoNetCDF.test.test_core.PseudoNetCDFFileTest.testSliceDimensionInt">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">testSliceDimensionInt</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">tncf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">testncf</span>
        <span class="n">o3</span> <span class="o">=</span> <span class="n">tncf</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;O3&#39;</span><span class="p">][:]</span>
        <span class="n">sncf</span> <span class="o">=</span> <span class="n">tncf</span><span class="o">.</span><span class="n">sliceDimensions</span><span class="p">(</span><span class="n">TSTEP</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sncf</span><span class="o">.</span><span class="n">dimensions</span><span class="p">[</span><span class="s1">&#39;TSTEP&#39;</span><span class="p">]),</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span>
            <span class="kc">True</span><span class="p">,</span> <span class="p">(</span><span class="n">sncf</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;O3&#39;</span><span class="p">][:]</span> <span class="o">==</span> <span class="n">o3</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">all</span><span class="p">())</span></div>


<div class="viewcode-block" id="PseudoNetCDFFileTest.testSliceDimensionList">
<a class="viewcode-back" href="../../../api/PseudoNetCDF.test.html#PseudoNetCDF.test.test_core.PseudoNetCDFFileTest.testSliceDimensionList">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">testSliceDimensionList</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">tncf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">testncf</span>
        <span class="n">o3</span> <span class="o">=</span> <span class="n">tncf</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;O3&#39;</span><span class="p">][:]</span>
        <span class="n">sncf</span> <span class="o">=</span> <span class="n">tncf</span><span class="o">.</span><span class="n">sliceDimensions</span><span class="p">(</span><span class="n">TSTEP</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sncf</span><span class="o">.</span><span class="n">dimensions</span><span class="p">[</span><span class="s1">&#39;TSTEP&#39;</span><span class="p">]),</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span>
            <span class="kc">True</span><span class="p">,</span> <span class="p">(</span><span class="n">sncf</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;O3&#39;</span><span class="p">][:]</span> <span class="o">==</span> <span class="n">o3</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">all</span><span class="p">())</span>
        <span class="n">sncf</span> <span class="o">=</span> <span class="n">tncf</span><span class="o">.</span><span class="n">sliceDimensions</span><span class="p">(</span><span class="n">TSTEP</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sncf</span><span class="o">.</span><span class="n">dimensions</span><span class="p">[</span><span class="s1">&#39;TSTEP&#39;</span><span class="p">]),</span> <span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span>
            <span class="kc">True</span><span class="p">,</span> <span class="p">(</span><span class="n">sncf</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;O3&#39;</span><span class="p">][:]</span> <span class="o">==</span> <span class="n">o3</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">]])</span><span class="o">.</span><span class="n">all</span><span class="p">())</span></div>


<div class="viewcode-block" id="PseudoNetCDFFileTest.testSliceDimensionComboListInt">
<a class="viewcode-back" href="../../../api/PseudoNetCDF.test.html#PseudoNetCDF.test.test_core.PseudoNetCDFFileTest.testSliceDimensionComboListInt">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">testSliceDimensionComboListInt</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">tncf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">testncf</span>
        <span class="n">o3</span> <span class="o">=</span> <span class="n">tncf</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;O3&#39;</span><span class="p">][:]</span>
        <span class="n">sncf</span> <span class="o">=</span> <span class="n">tncf</span><span class="o">.</span><span class="n">sliceDimensions</span><span class="p">(</span><span class="n">TSTEP</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">],</span> <span class="n">ROW</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">COL</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sncf</span><span class="o">.</span><span class="n">dimensions</span><span class="p">[</span><span class="s1">&#39;TSTEP&#39;</span><span class="p">]),</span> <span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sncf</span><span class="o">.</span><span class="n">dimensions</span><span class="p">[</span><span class="s1">&#39;ROW&#39;</span><span class="p">]),</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sncf</span><span class="o">.</span><span class="n">dimensions</span><span class="p">[</span><span class="s1">&#39;COL&#39;</span><span class="p">]),</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="p">(</span><span class="n">sncf</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;O3&#39;</span><span class="p">][:]</span> <span class="o">==</span> <span class="n">o3</span><span class="p">[[</span>
                         <span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">],</span> <span class="p">:,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">][:,</span> <span class="p">:,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">])</span><span class="o">.</span><span class="n">all</span><span class="p">())</span></div>


<div class="viewcode-block" id="PseudoNetCDFFileTest.testSliceDimensionMultiArray">
<a class="viewcode-back" href="../../../api/PseudoNetCDF.test.html#PseudoNetCDF.test.test_core.PseudoNetCDFFileTest.testSliceDimensionMultiArray">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">testSliceDimensionMultiArray</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">tncf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">testncf</span>
        <span class="n">o3</span> <span class="o">=</span> <span class="n">tncf</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;O3&#39;</span><span class="p">][:]</span>
        <span class="n">i</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
        <span class="n">sncf</span> <span class="o">=</span> <span class="n">tncf</span><span class="o">.</span><span class="n">sliceDimensions</span><span class="p">(</span><span class="n">TSTEP</span><span class="o">=</span><span class="n">i</span><span class="p">,</span> <span class="n">LAY</span><span class="o">=</span><span class="n">i</span><span class="p">,</span> <span class="n">ROW</span><span class="o">=</span><span class="n">i</span><span class="p">,</span> <span class="n">COL</span><span class="o">=</span><span class="n">i</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sncf</span><span class="o">.</span><span class="n">dimensions</span><span class="p">[</span><span class="s1">&#39;POINTS&#39;</span><span class="p">]),</span> <span class="mi">4</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span>
            <span class="kc">True</span><span class="p">,</span> <span class="p">(</span><span class="n">sncf</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;O3&#39;</span><span class="p">][:]</span> <span class="o">==</span> <span class="n">o3</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">i</span><span class="p">])</span><span class="o">.</span><span class="n">all</span><span class="p">())</span></div>


<div class="viewcode-block" id="PseudoNetCDFFileTest.testSliceDimensionSlice">
<a class="viewcode-back" href="../../../api/PseudoNetCDF.test.html#PseudoNetCDF.test.test_core.PseudoNetCDFFileTest.testSliceDimensionSlice">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">testSliceDimensionSlice</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">tncf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">testncf</span>
        <span class="n">o3</span> <span class="o">=</span> <span class="n">tncf</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;O3&#39;</span><span class="p">][:]</span>
        <span class="n">sncf</span> <span class="o">=</span> <span class="n">tncf</span><span class="o">.</span><span class="n">sliceDimensions</span><span class="p">(</span><span class="n">ROW</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sncf</span><span class="o">.</span><span class="n">dimensions</span><span class="p">[</span><span class="s1">&#39;ROW&#39;</span><span class="p">]),</span> <span class="mi">3</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span>
            <span class="kc">True</span><span class="p">,</span> <span class="p">(</span><span class="n">sncf</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;O3&#39;</span><span class="p">][:]</span> <span class="o">==</span> <span class="n">o3</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span> <span class="p">:])</span><span class="o">.</span><span class="n">all</span><span class="p">())</span></div>


<div class="viewcode-block" id="PseudoNetCDFFileTest.testSliceDimensionMultiSlice">
<a class="viewcode-back" href="../../../api/PseudoNetCDF.test.html#PseudoNetCDF.test.test_core.PseudoNetCDFFileTest.testSliceDimensionMultiSlice">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">testSliceDimensionMultiSlice</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">tncf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">testncf</span>
        <span class="n">o3</span> <span class="o">=</span> <span class="n">tncf</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;O3&#39;</span><span class="p">][:]</span>
        <span class="n">sncf</span> <span class="o">=</span> <span class="n">tncf</span><span class="o">.</span><span class="n">sliceDimensions</span><span class="p">(</span>
            <span class="n">LAY</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">ROW</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">COL</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sncf</span><span class="o">.</span><span class="n">dimensions</span><span class="p">[</span><span class="s1">&#39;LAY&#39;</span><span class="p">]),</span> <span class="mi">3</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sncf</span><span class="o">.</span><span class="n">dimensions</span><span class="p">[</span><span class="s1">&#39;ROW&#39;</span><span class="p">]),</span> <span class="mi">3</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sncf</span><span class="o">.</span><span class="n">dimensions</span><span class="p">[</span><span class="s1">&#39;COL&#39;</span><span class="p">]),</span> <span class="mi">3</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span>
            <span class="kc">True</span><span class="p">,</span> <span class="p">(</span><span class="n">sncf</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;O3&#39;</span><span class="p">][:]</span> <span class="o">==</span> <span class="n">o3</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">])</span><span class="o">.</span><span class="n">all</span><span class="p">())</span></div>


<div class="viewcode-block" id="PseudoNetCDFFileTest.testApplyAlongDimensionsNamed">
<a class="viewcode-back" href="../../../api/PseudoNetCDF.test.html#PseudoNetCDF.test.test_core.PseudoNetCDFFileTest.testApplyAlongDimensionsNamed">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">testApplyAlongDimensionsNamed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">tncf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">testncf</span>
        <span class="n">o3</span> <span class="o">=</span> <span class="n">tncf</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;O3&#39;</span><span class="p">][:]</span>
        <span class="n">ancf</span> <span class="o">=</span> <span class="n">tncf</span><span class="o">.</span><span class="n">applyAlongDimensions</span><span class="p">(</span><span class="n">LAY</span><span class="o">=</span><span class="s1">&#39;min&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span>
            <span class="kc">True</span><span class="p">,</span> <span class="p">(</span><span class="n">ancf</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;O3&#39;</span><span class="p">][:]</span> <span class="o">==</span> <span class="n">o3</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">keepdims</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span><span class="o">.</span><span class="n">all</span><span class="p">())</span></div>


<div class="viewcode-block" id="PseudoNetCDFFileTest.testApplyAlongDimensionsMultiNamed">
<a class="viewcode-back" href="../../../api/PseudoNetCDF.test.html#PseudoNetCDF.test.test_core.PseudoNetCDFFileTest.testApplyAlongDimensionsMultiNamed">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">testApplyAlongDimensionsMultiNamed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">tncf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">testncf</span>
        <span class="n">o3</span> <span class="o">=</span> <span class="n">tncf</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;O3&#39;</span><span class="p">][:]</span>
        <span class="n">ancf</span> <span class="o">=</span> <span class="n">tncf</span><span class="o">.</span><span class="n">applyAlongDimensions</span><span class="p">(</span><span class="n">LAY</span><span class="o">=</span><span class="s1">&#39;min&#39;</span><span class="p">,</span> <span class="n">ROW</span><span class="o">=</span><span class="s1">&#39;max&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="p">(</span><span class="n">ancf</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;O3&#39;</span><span class="p">][:]</span> <span class="o">==</span> <span class="n">o3</span><span class="o">.</span><span class="n">min</span><span class="p">(</span>
            <span class="mi">1</span><span class="p">,</span> <span class="n">keepdims</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">keepdims</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span><span class="o">.</span><span class="n">all</span><span class="p">())</span></div>


<div class="viewcode-block" id="PseudoNetCDFFileTest.testApplyAlongDimensionsConvolve">
<a class="viewcode-back" href="../../../api/PseudoNetCDF.test.html#PseudoNetCDF.test.test_core.PseudoNetCDFFileTest.testApplyAlongDimensionsConvolve">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">testApplyAlongDimensionsConvolve</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">tncf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">testncf</span>
        <span class="n">o3</span> <span class="o">=</span> <span class="n">tncf</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;O3&#39;</span><span class="p">][:]</span>
        <span class="n">ancf</span> <span class="o">=</span> <span class="n">tncf</span><span class="o">.</span><span class="n">applyAlongDimensions</span><span class="p">(</span><span class="n">TSTEP</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">convolve</span><span class="p">(</span>
            <span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;f&#39;</span><span class="p">)</span> <span class="o">/</span> <span class="mf">2.</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;valid&#39;</span><span class="p">))</span>
        <span class="n">co3</span> <span class="o">=</span> <span class="p">(</span><span class="n">o3</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">+</span> <span class="n">o3</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="mi">2</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="p">(</span><span class="n">ancf</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;O3&#39;</span><span class="p">][:]</span> <span class="o">==</span> <span class="n">co3</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">())</span></div>


<div class="viewcode-block" id="PseudoNetCDFFileTest.testApplyAlongDimensionsConvolveWithMax">
<a class="viewcode-back" href="../../../api/PseudoNetCDF.test.html#PseudoNetCDF.test.test_core.PseudoNetCDFFileTest.testApplyAlongDimensionsConvolveWithMax">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">testApplyAlongDimensionsConvolveWithMax</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">tncf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">testncf</span>
        <span class="n">o3</span> <span class="o">=</span> <span class="n">tncf</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;O3&#39;</span><span class="p">][:]</span>
        <span class="n">co3</span> <span class="o">=</span> <span class="p">(</span><span class="n">o3</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">+</span> <span class="n">o3</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="mi">2</span>
        <span class="c1"># Testing convolution; useful for mda8</span>

        <span class="k">def</span><span class="w"> </span><span class="nf">convf</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">convolve</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;f&#39;</span><span class="p">)</span> <span class="o">/</span> <span class="mf">2.</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;valid&#39;</span><span class="p">)</span>

        <span class="n">ancf</span> <span class="o">=</span> <span class="n">tncf</span><span class="o">.</span><span class="n">applyAlongDimensions</span><span class="p">(</span><span class="n">TSTEP</span><span class="o">=</span><span class="n">convf</span><span class="p">)</span>\
                   <span class="o">.</span><span class="n">applyAlongDimensions</span><span class="p">(</span><span class="n">TSTEP</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">)</span>
        <span class="n">mco3</span> <span class="o">=</span> <span class="n">co3</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">keepdims</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="p">(</span><span class="n">ancf</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;O3&#39;</span><span class="p">][:]</span> <span class="o">==</span> <span class="n">mco3</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">())</span></div>


<div class="viewcode-block" id="PseudoNetCDFFileTest.testAdd">
<a class="viewcode-back" href="../../../api/PseudoNetCDF.test.html#PseudoNetCDF.test.test_core.PseudoNetCDFFileTest.testAdd">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">testAdd</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">tncf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">testncf</span>
        <span class="n">o3</span> <span class="o">=</span> <span class="n">tncf</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;O3&#39;</span><span class="p">][:]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">tmpf</span> <span class="o">=</span> <span class="n">tncf</span> <span class="o">+</span> <span class="n">tncf</span>
        <span class="n">np_all_close</span><span class="p">(</span><span class="n">tmpf</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;O3&#39;</span><span class="p">][:],</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">o3</span><span class="p">)</span></div>


<div class="viewcode-block" id="PseudoNetCDFFileTest.testSub">
<a class="viewcode-back" href="../../../api/PseudoNetCDF.test.html#PseudoNetCDF.test.test_core.PseudoNetCDFFileTest.testSub">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">testSub</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">tncf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">testncf</span>
        <span class="n">o3</span> <span class="o">=</span> <span class="n">tncf</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;O3&#39;</span><span class="p">][:]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">tmpf</span> <span class="o">=</span> <span class="n">tncf</span> <span class="o">-</span> <span class="n">tncf</span>
        <span class="n">np_all_close</span><span class="p">(</span><span class="n">tmpf</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;O3&#39;</span><span class="p">][:],</span> <span class="n">o3</span> <span class="o">-</span> <span class="n">o3</span><span class="p">)</span></div>


<div class="viewcode-block" id="PseudoNetCDFFileTest.testDiv">
<a class="viewcode-back" href="../../../api/PseudoNetCDF.test.html#PseudoNetCDF.test.test_core.PseudoNetCDFFileTest.testDiv">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">testDiv</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">tncf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">testncf</span>
        <span class="n">o3</span> <span class="o">=</span> <span class="n">tncf</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;O3&#39;</span><span class="p">][:]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">np</span><span class="o">.</span><span class="n">seterr</span><span class="p">(</span><span class="n">invalid</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
        <span class="n">tmpf</span> <span class="o">=</span> <span class="n">tncf</span> <span class="o">/</span> <span class="n">tncf</span>
        <span class="n">np_all_close</span><span class="p">(</span><span class="n">tmpf</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;O3&#39;</span><span class="p">][:],</span> <span class="n">o3</span> <span class="o">/</span> <span class="n">o3</span><span class="p">)</span>
        <span class="n">np</span><span class="o">.</span><span class="n">seterr</span><span class="p">(</span><span class="n">invalid</span><span class="o">=</span><span class="s1">&#39;warn&#39;</span><span class="p">)</span></div>


<div class="viewcode-block" id="PseudoNetCDFFileTest.testMul">
<a class="viewcode-back" href="../../../api/PseudoNetCDF.test.html#PseudoNetCDF.test.test_core.PseudoNetCDFFileTest.testMul">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">testMul</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">tncf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">testncf</span>
        <span class="n">o3</span> <span class="o">=</span> <span class="n">tncf</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;O3&#39;</span><span class="p">][:]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">tmpf</span> <span class="o">=</span> <span class="n">tncf</span> <span class="o">*</span> <span class="n">tncf</span>
        <span class="n">np_all_close</span><span class="p">(</span><span class="n">tmpf</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;O3&#39;</span><span class="p">][:],</span> <span class="n">o3</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span></div>


<div class="viewcode-block" id="PseudoNetCDFFileTest.testPow">
<a class="viewcode-back" href="../../../api/PseudoNetCDF.test.html#PseudoNetCDF.test.test_core.PseudoNetCDFFileTest.testPow">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">testPow</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">tncf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">testncf</span>
        <span class="n">o3</span> <span class="o">=</span> <span class="n">tncf</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;O3&#39;</span><span class="p">][:]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">np</span><span class="o">.</span><span class="n">seterr</span><span class="p">(</span><span class="n">over</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">,</span> <span class="n">invalid</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
        <span class="n">tmpf</span> <span class="o">=</span> <span class="n">tncf</span> <span class="o">**</span> <span class="n">tncf</span>
        <span class="n">np_all_close</span><span class="p">(</span><span class="n">tmpf</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;O3&#39;</span><span class="p">][:],</span> <span class="n">o3</span><span class="o">**</span><span class="n">o3</span><span class="p">)</span>
        <span class="n">np</span><span class="o">.</span><span class="n">seterr</span><span class="p">(</span><span class="n">over</span><span class="o">=</span><span class="s1">&#39;warn&#39;</span><span class="p">,</span> <span class="n">invalid</span><span class="o">=</span><span class="s1">&#39;warn&#39;</span><span class="p">)</span></div>


<div class="viewcode-block" id="PseudoNetCDFFileTest.testMod">
<a class="viewcode-back" href="../../../api/PseudoNetCDF.test.html#PseudoNetCDF.test.test_core.PseudoNetCDFFileTest.testMod">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">testMod</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">tncf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">testncf</span>
        <span class="n">o3</span> <span class="o">=</span> <span class="n">tncf</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;O3&#39;</span><span class="p">][:]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">np</span><span class="o">.</span><span class="n">seterr</span><span class="p">(</span><span class="n">divide</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
        <span class="n">tmpf</span> <span class="o">=</span> <span class="n">tncf</span> <span class="o">%</span> <span class="n">tncf</span>
        <span class="n">np_all_close</span><span class="p">(</span><span class="n">tmpf</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;O3&#39;</span><span class="p">][:],</span> <span class="n">o3</span> <span class="o">%</span> <span class="n">o3</span><span class="p">)</span>
        <span class="n">np</span><span class="o">.</span><span class="n">seterr</span><span class="p">(</span><span class="n">divide</span><span class="o">=</span><span class="s1">&#39;warn&#39;</span><span class="p">)</span></div>


<div class="viewcode-block" id="PseudoNetCDFFileTest.testXAdd">
<a class="viewcode-back" href="../../../api/PseudoNetCDF.test.html#PseudoNetCDF.test.test_core.PseudoNetCDFFileTest.testXAdd">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">testXAdd</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">tncf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">testncf</span>
        <span class="n">o3</span> <span class="o">=</span> <span class="n">tncf</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;O3&#39;</span><span class="p">][:]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">tmpf</span> <span class="o">=</span> <span class="n">tncf</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">tmpf</span><span class="o">.</span><span class="n">_operator_exclude_vars</span><span class="p">)</span>
        <span class="n">tmpf</span><span class="o">.</span><span class="n">setCoords</span><span class="p">([</span><span class="s1">&#39;O3&#39;</span><span class="p">])</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">tmpf</span><span class="o">.</span><span class="n">_operator_exclude_vars</span><span class="p">)</span>
        <span class="n">tmpf</span> <span class="o">=</span> <span class="n">tmpf</span> <span class="o">+</span> <span class="n">tncf</span>
        <span class="n">np_all_close</span><span class="p">(</span><span class="n">tmpf</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;O3&#39;</span><span class="p">][:],</span> <span class="n">o3</span><span class="p">)</span></div>


<div class="viewcode-block" id="PseudoNetCDFFileTest.testGetMap">
<a class="viewcode-back" href="../../../api/PseudoNetCDF.test.html#PseudoNetCDF.test.test_core.PseudoNetCDFFileTest.testGetMap">[docs]</a>
    <span class="nd">@requires_basemap</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">testGetMap</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">tncf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">testncf</span>
        <span class="n">tncf</span><span class="o">.</span><span class="n">getMap</span><span class="p">(</span><span class="n">maptype</span><span class="o">=</span><span class="s1">&#39;basemap_auto&#39;</span><span class="p">)</span></div>


<div class="viewcode-block" id="PseudoNetCDFFileTest.testPlot">
<a class="viewcode-back" href="../../../api/PseudoNetCDF.test.html#PseudoNetCDF.test.test_core.PseudoNetCDFFileTest.testPlot">[docs]</a>
    <span class="nd">@requires_matplotlib</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">testPlot</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">tncf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">testncf</span>
        <span class="n">_</span> <span class="o">=</span> <span class="n">tncf</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="s1">&#39;O3&#39;</span><span class="p">)</span></div>


<div class="viewcode-block" id="PseudoNetCDFFileTest.testGetproj">
<a class="viewcode-back" href="../../../api/PseudoNetCDF.test.html#PseudoNetCDF.test.test_core.PseudoNetCDFFileTest.testGetproj">[docs]</a>
    <span class="nd">@requires_pyproj</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">testGetproj</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">tncf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">testncf</span>
        <span class="n">tncf</span><span class="o">.</span><span class="n">getproj</span><span class="p">(</span><span class="n">withgrid</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">projformat</span><span class="o">=</span><span class="s1">&#39;pyproj&#39;</span><span class="p">)</span></div>


<div class="viewcode-block" id="PseudoNetCDFFileTest.testLl2xy">
<a class="viewcode-back" href="../../../api/PseudoNetCDF.test.html#PseudoNetCDF.test.test_core.PseudoNetCDFFileTest.testLl2xy">[docs]</a>
    <span class="nd">@requires_pyproj</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">testLl2xy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">tncf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">testncf</span>
        <span class="n">crs</span> <span class="o">=</span> <span class="n">tncf</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;lambert_conformal_conic&#39;</span><span class="p">]</span>
        <span class="n">y0</span> <span class="o">=</span> <span class="n">crs</span><span class="o">.</span><span class="n">false_northing</span>
        <span class="n">x0</span> <span class="o">=</span> <span class="n">crs</span><span class="o">.</span><span class="n">false_easting</span>
        <span class="n">lon0</span><span class="p">,</span> <span class="n">lat0</span> <span class="o">=</span> <span class="n">tncf</span><span class="o">.</span><span class="n">xy2ll</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">)</span>
        <span class="n">x0t</span><span class="p">,</span> <span class="n">y0t</span> <span class="o">=</span> <span class="n">tncf</span><span class="o">.</span><span class="n">ll2xy</span><span class="p">(</span><span class="n">lon0</span><span class="p">,</span> <span class="n">lat0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">((</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">),</span> <span class="p">(</span><span class="n">x0t</span><span class="p">,</span> <span class="n">y0t</span><span class="p">))</span></div>


<div class="viewcode-block" id="PseudoNetCDFFileTest.testLl2ij">
<a class="viewcode-back" href="../../../api/PseudoNetCDF.test.html#PseudoNetCDF.test.test_core.PseudoNetCDFFileTest.testLl2ij">[docs]</a>
    <span class="nd">@requires_pyproj</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">testLl2ij</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">tncf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">testncf</span>
        <span class="n">y0</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">x0</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">lon0</span><span class="p">,</span> <span class="n">lat0</span> <span class="o">=</span> <span class="n">tncf</span><span class="o">.</span><span class="n">xy2ll</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">)</span>
        <span class="n">i0</span><span class="p">,</span> <span class="n">j0</span> <span class="o">=</span> <span class="n">tncf</span><span class="o">.</span><span class="n">ll2ij</span><span class="p">(</span><span class="n">lon0</span><span class="p">,</span> <span class="n">lat0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">i0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">j0</span><span class="p">)</span></div>


<div class="viewcode-block" id="PseudoNetCDFFileTest.testTime2t">
<a class="viewcode-back" href="../../../api/PseudoNetCDF.test.html#PseudoNetCDF.test.test_core.PseudoNetCDFFileTest.testTime2t">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">testTime2t</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="kn">import</span> <span class="n">datetime</span>
        <span class="n">time</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
            <span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="s1">&#39;1970-01-</span><span class="si">{}</span><span class="s1">+0000&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1"> %H:%M%z&#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="p">[</span>
                <span class="s1">&#39;01 00:20&#39;</span><span class="p">,</span> <span class="s1">&#39;01 01:20&#39;</span><span class="p">,</span> <span class="s1">&#39;01 01:40&#39;</span><span class="p">,</span> <span class="s1">&#39;01 06:00&#39;</span><span class="p">,</span> <span class="s1">&#39;02 01:00&#39;</span>
            <span class="p">]</span>
        <span class="p">])</span>
        <span class="n">tncf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">testncf</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">tncf</span><span class="o">.</span><span class="n">time2t</span><span class="p">(</span><span class="n">time</span><span class="p">[:])</span>
        <span class="n">np_all_close</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">23</span><span class="p">])</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">tncf</span><span class="o">.</span><span class="n">time2t</span><span class="p">(</span><span class="n">time</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">ttype</span><span class="o">=</span><span class="s1">&#39;bounds&#39;</span><span class="p">)</span>
        <span class="n">np_all_close</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">])</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">tncf</span><span class="o">.</span><span class="n">time2t</span><span class="p">(</span><span class="n">time</span><span class="p">[:],</span> <span class="n">ttype</span><span class="o">=</span><span class="s1">&#39;bounds_close&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">23</span><span class="p">]))</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">tncf</span><span class="o">.</span><span class="n">time2t</span><span class="p">(</span><span class="n">time</span><span class="p">[:],</span> <span class="n">ttype</span><span class="o">=</span><span class="s1">&#39;bounds&#39;</span><span class="p">)</span>
        <span class="n">np_all_close</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">masked_invalid</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">23</span><span class="p">]))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">mask</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="kc">True</span><span class="p">)</span></div>


<div class="viewcode-block" id="PseudoNetCDFFileTest.testTime2idx">
<a class="viewcode-back" href="../../../api/PseudoNetCDF.test.html#PseudoNetCDF.test.test_core.PseudoNetCDFFileTest.testTime2idx">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">testTime2idx</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="kn">import</span> <span class="n">datetime</span>
        <span class="n">time</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
            <span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="s1">&#39;1970-01-</span><span class="si">{}</span><span class="s1">+0000&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1"> %H:%M%z&#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="p">[</span>
                <span class="s1">&#39;01 00:20&#39;</span><span class="p">,</span> <span class="s1">&#39;01 01:20&#39;</span><span class="p">,</span> <span class="s1">&#39;01 01:40&#39;</span><span class="p">,</span> <span class="s1">&#39;01 06:00&#39;</span><span class="p">,</span> <span class="s1">&#39;02 01:00&#39;</span>
            <span class="p">]</span>
        <span class="p">])</span>
        <span class="n">tncf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">testncf</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">tncf</span><span class="o">.</span><span class="n">time2idx</span><span class="p">(</span><span class="n">time</span><span class="p">[:])</span>
        <span class="n">np_all_close</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">23</span><span class="p">])</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">tncf</span><span class="o">.</span><span class="n">time2idx</span><span class="p">(</span>
            <span class="n">time</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;bounds&#39;</span><span class="p">,</span> <span class="n">clean</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span>
            <span class="n">left</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mi">999</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">np_all_close</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">999</span><span class="p">])</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">tncf</span><span class="o">.</span><span class="n">time2idx</span><span class="p">(</span><span class="n">time</span><span class="p">[:],</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;bounds&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">23</span><span class="p">]))</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">tncf</span><span class="o">.</span><span class="n">time2idx</span><span class="p">(</span><span class="n">time</span><span class="p">[:],</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;bounds&#39;</span><span class="p">,</span> <span class="n">clean</span><span class="o">=</span><span class="s1">&#39;mask&#39;</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
        <span class="n">np_all_close</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">masked_invalid</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">]))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">mask</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="kc">True</span><span class="p">)</span></div>


<div class="viewcode-block" id="PseudoNetCDFFileTest.testXy2ll">
<a class="viewcode-back" href="../../../api/PseudoNetCDF.test.html#PseudoNetCDF.test.test_core.PseudoNetCDFFileTest.testXy2ll">[docs]</a>
    <span class="nd">@requires_pyproj</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">testXy2ll</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">tncf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">testncf</span>
        <span class="n">crs</span> <span class="o">=</span> <span class="n">tncf</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;lambert_conformal_conic&#39;</span><span class="p">]</span>
        <span class="n">y0</span> <span class="o">=</span> <span class="n">crs</span><span class="o">.</span><span class="n">false_northing</span>
        <span class="n">x0</span> <span class="o">=</span> <span class="n">crs</span><span class="o">.</span><span class="n">false_easting</span>
        <span class="n">lonmid</span><span class="p">,</span> <span class="n">latmid</span> <span class="o">=</span> <span class="n">tncf</span><span class="o">.</span><span class="n">xy2ll</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span>
            <span class="n">lonmid</span><span class="p">,</span> <span class="n">crs</span><span class="o">.</span><span class="n">longitude_of_central_meridian</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span>
            <span class="n">latmid</span><span class="p">,</span> <span class="n">crs</span><span class="o">.</span><span class="n">latitude_of_projection_origin</span><span class="p">))</span>
        <span class="n">lon0</span><span class="p">,</span> <span class="n">lat0</span> <span class="o">=</span> <span class="n">tncf</span><span class="o">.</span><span class="n">xy2ll</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span>
            <span class="n">lon0</span><span class="p">,</span> <span class="n">tncf</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;longitude_bounds&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span>
            <span class="n">lat0</span><span class="p">,</span> <span class="n">tncf</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;latitude_bounds&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]))</span></div>


<div class="viewcode-block" id="PseudoNetCDFFileTest.testIj2ll">
<a class="viewcode-back" href="../../../api/PseudoNetCDF.test.html#PseudoNetCDF.test.test_core.PseudoNetCDFFileTest.testIj2ll">[docs]</a>
    <span class="nd">@requires_pyproj</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">testIj2ll</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">tncf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">testncf</span>
        <span class="n">lon0</span><span class="p">,</span> <span class="n">lat0</span> <span class="o">=</span> <span class="n">tncf</span><span class="o">.</span><span class="n">ij2ll</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span>
            <span class="n">lon0</span><span class="p">,</span> <span class="n">tncf</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;longitude&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span>
            <span class="n">lat0</span><span class="p">,</span> <span class="n">tncf</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;latitude&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]))</span></div>


<div class="viewcode-block" id="PseudoNetCDFFileTest.testEval">
<a class="viewcode-back" href="../../../api/PseudoNetCDF.test.html#PseudoNetCDF.test.test_core.PseudoNetCDFFileTest.testEval">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">testEval</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">tncf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">testncf</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">tncf</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="s1">&#39;O3_PPB = O3 * 1000.&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">copyall</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">o3ppmv</span> <span class="o">=</span> <span class="n">tncf</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;O3&#39;</span><span class="p">]</span>
        <span class="n">o3ppbv</span> <span class="o">=</span> <span class="n">tncf</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;O3_PPB&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="p">((</span><span class="n">o3ppmv</span> <span class="o">*</span> <span class="mf">1000.</span><span class="p">)</span> <span class="o">==</span> <span class="n">o3ppbv</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">())</span></div>


<div class="viewcode-block" id="PseudoNetCDFFileTest.testSetncatts">
<a class="viewcode-back" href="../../../api/PseudoNetCDF.test.html#PseudoNetCDF.test.test_core.PseudoNetCDFFileTest.testSetncatts">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">testSetncatts</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">tncf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">testncf</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">tncf</span><span class="o">.</span><span class="n">setncatts</span><span class="p">({</span><span class="s1">&#39;test_new1&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;test_new2&#39;</span><span class="p">:</span> <span class="s1">&#39;five&#39;</span><span class="p">})</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">tncf</span><span class="o">.</span><span class="n">test_new1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">tncf</span><span class="o">.</span><span class="n">test_new2</span><span class="p">,</span> <span class="s1">&#39;five&#39;</span><span class="p">)</span></div>


<div class="viewcode-block" id="PseudoNetCDFFileTest.testGetncatts">
<a class="viewcode-back" href="../../../api/PseudoNetCDF.test.html#PseudoNetCDF.test.test_core.PseudoNetCDFFileTest.testGetncatts">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">testGetncatts</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">tncf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">testncf</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">tncf</span><span class="o">.</span><span class="n">getncatts</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="s1">&#39;str_one&#39;</span><span class="p">],</span> <span class="s1">&#39;1&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="s1">&#39;int_two&#39;</span><span class="p">],</span> <span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="s1">&#39;float_threeptfive&#39;</span><span class="p">],</span> <span class="mf">3.5</span><span class="p">)</span></div>


<div class="viewcode-block" id="PseudoNetCDFFileTest.testCopy">
<a class="viewcode-back" href="../../../api/PseudoNetCDF.test.html#PseudoNetCDF.test.test_core.PseudoNetCDFFileTest.testCopy">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">testCopy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">tncf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">testncf</span>
        <span class="n">nncf</span> <span class="o">=</span> <span class="n">tncf</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">props</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">dimensions</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                         <span class="n">variables</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">pk</span> <span class="ow">in</span> <span class="n">tncf</span><span class="o">.</span><span class="n">ncattrs</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">tncf</span><span class="p">,</span> <span class="n">pk</span><span class="p">),</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">nncf</span><span class="p">,</span> <span class="n">pk</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span>

        <span class="k">for</span> <span class="n">dk</span><span class="p">,</span> <span class="n">dv</span> <span class="ow">in</span> <span class="n">tncf</span><span class="o">.</span><span class="n">dimensions</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">dvl</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">dv</span><span class="p">)</span>
            <span class="n">ndvl</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">nncf</span><span class="o">.</span><span class="n">dimensions</span><span class="p">[</span><span class="n">dk</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">dvl</span><span class="p">,</span> <span class="n">ndvl</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">vk</span><span class="p">,</span> <span class="n">vv</span> <span class="ow">in</span> <span class="n">tncf</span><span class="o">.</span><span class="n">variables</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">nvv</span> <span class="o">=</span> <span class="n">nncf</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="n">vk</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">vv</span><span class="p">[</span><span class="o">...</span><span class="p">],</span> <span class="n">nvv</span><span class="p">[</span><span class="o">...</span><span class="p">]))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">vv</span><span class="o">.</span><span class="n">dimensions</span><span class="p">,</span> <span class="n">nvv</span><span class="o">.</span><span class="n">dimensions</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">vv</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">char</span><span class="p">,</span> <span class="n">nvv</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">char</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">pk</span> <span class="ow">in</span> <span class="n">vv</span><span class="o">.</span><span class="n">ncattrs</span><span class="p">():</span>
                <span class="n">pv</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">vv</span><span class="p">,</span> <span class="n">pk</span><span class="p">)</span>
                <span class="n">npv</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">nvv</span><span class="p">,</span> <span class="n">pk</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
                <span class="n">testv</span> <span class="o">=</span> <span class="n">pv</span> <span class="o">==</span> <span class="n">npv</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">testv</span><span class="p">))</span></div>


<div class="viewcode-block" id="PseudoNetCDFFileTest.testGetTimes">
<a class="viewcode-back" href="../../../api/PseudoNetCDF.test.html#PseudoNetCDF.test.test_core.PseudoNetCDFFileTest.testGetTimes">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">testGetTimes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">tncf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">testncf</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">tncf</span><span class="o">.</span><span class="n">getTimes</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="p">(</span><span class="n">t</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">mytimes</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">())</span></div>


<div class="viewcode-block" id="PseudoNetCDFFileTest.testStack">
<a class="viewcode-back" href="../../../api/PseudoNetCDF.test.html#PseudoNetCDF.test.test_core.PseudoNetCDFFileTest.testStack">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">testStack</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">tncf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">testncf</span>
        <span class="n">sncf</span> <span class="o">=</span> <span class="n">tncf</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">tncf</span><span class="p">,</span> <span class="s1">&#39;TSTEP&#39;</span><span class="p">)</span>
        <span class="n">to3</span> <span class="o">=</span> <span class="n">tncf</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;O3&#39;</span><span class="p">][:]</span>
        <span class="n">no3</span> <span class="o">=</span> <span class="n">sncf</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;O3&#39;</span><span class="p">][:]</span>
        <span class="n">origlen</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">tncf</span><span class="o">.</span><span class="n">dimensions</span><span class="p">[</span><span class="s1">&#39;TSTEP&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">origlen</span> <span class="o">*</span> <span class="mi">2</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">sncf</span><span class="o">.</span><span class="n">dimensions</span><span class="p">[</span><span class="s1">&#39;TSTEP&#39;</span><span class="p">]))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">to3</span><span class="p">,</span> <span class="n">no3</span><span class="p">[:</span><span class="n">origlen</span><span class="p">]))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">to3</span><span class="p">,</span> <span class="n">no3</span><span class="p">[</span><span class="n">origlen</span><span class="p">:]))</span></div>


<div class="viewcode-block" id="PseudoNetCDFFileTest.testRemoveSingleton">
<a class="viewcode-back" href="../../../api/PseudoNetCDF.test.html#PseudoNetCDF.test.test_core.PseudoNetCDFFileTest.testRemoveSingleton">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">testRemoveSingleton</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">tncf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">testncf</span>
        <span class="n">nncf</span> <span class="o">=</span> <span class="n">tncf</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">nncf</span><span class="o">.</span><span class="n">createDimension</span><span class="p">(</span><span class="s1">&#39;test&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">nncf</span> <span class="o">=</span> <span class="n">nncf</span><span class="o">.</span><span class="n">removeSingleton</span><span class="p">(</span><span class="n">dimkey</span><span class="o">=</span><span class="s1">&#39;test&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">tncf</span><span class="o">.</span><span class="n">dimensions</span><span class="p">),</span> <span class="nb">set</span><span class="p">(</span><span class="n">nncf</span><span class="o">.</span><span class="n">dimensions</span><span class="p">))</span>
        <span class="n">nncf</span><span class="o">.</span><span class="n">createDimension</span><span class="p">(</span><span class="s1">&#39;test&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">nncf</span> <span class="o">=</span> <span class="n">nncf</span><span class="o">.</span><span class="n">removeSingleton</span><span class="p">(</span><span class="n">dimkey</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">tncf</span><span class="o">.</span><span class="n">dimensions</span><span class="p">),</span> <span class="nb">set</span><span class="p">(</span><span class="n">nncf</span><span class="o">.</span><span class="n">dimensions</span><span class="p">))</span></div>


<div class="viewcode-block" id="PseudoNetCDFFileTest.testCreateDimension">
<a class="viewcode-back" href="../../../api/PseudoNetCDF.test.html#PseudoNetCDF.test.test_core.PseudoNetCDFFileTest.testCreateDimension">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">testCreateDimension</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">tncf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">testncf</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">ndims</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">tncf</span><span class="o">.</span><span class="n">dimensions</span><span class="p">)</span>
        <span class="n">olddims</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">tncf</span><span class="o">.</span><span class="n">dimensions</span><span class="p">)</span>
        <span class="n">newdims</span> <span class="o">=</span> <span class="n">olddims</span><span class="o">.</span><span class="n">union</span><span class="p">([</span><span class="s1">&#39;newd&#39;</span><span class="p">])</span>
        <span class="n">tncf</span><span class="o">.</span><span class="n">createDimension</span><span class="p">(</span><span class="s1">&#39;newd&#39;</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">tncf</span><span class="o">.</span><span class="n">dimensions</span><span class="p">),</span> <span class="n">ndims</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">tncf</span><span class="o">.</span><span class="n">dimensions</span><span class="p">),</span> <span class="n">newdims</span><span class="p">)</span></div>


<div class="viewcode-block" id="PseudoNetCDFFileTest.testCreateVariable">
<a class="viewcode-back" href="../../../api/PseudoNetCDF.test.html#PseudoNetCDF.test.test_core.PseudoNetCDFFileTest.testCreateVariable">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">testCreateVariable</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">tncf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">testncf</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">nvars</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">tncf</span><span class="o">.</span><span class="n">variables</span><span class="p">)</span>
        <span class="n">var</span> <span class="o">=</span> <span class="n">tncf</span><span class="o">.</span><span class="n">createVariable</span><span class="p">(</span><span class="s1">&#39;test&#39;</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;TSTEP&#39;</span><span class="p">,))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">tncf</span><span class="o">.</span><span class="n">variables</span><span class="p">),</span> <span class="n">nvars</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">var</span><span class="o">.</span><span class="n">dimensions</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;TSTEP&#39;</span><span class="p">,))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">var</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">char</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">)</span></div>


<div class="viewcode-block" id="PseudoNetCDFFileTest.testSave">
<a class="viewcode-back" href="../../../api/PseudoNetCDF.test.html#PseudoNetCDF.test.test_core.PseudoNetCDFFileTest.testSave">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">testSave</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="kn">import</span><span class="w"> </span><span class="nn">tempfile</span>
        <span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
        <span class="n">tncf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">testncf</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">to3</span> <span class="o">=</span> <span class="n">tncf</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;O3&#39;</span><span class="p">][:]</span>
        <span class="k">with</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">TemporaryDirectory</span><span class="p">()</span> <span class="k">as</span> <span class="n">tmpdirname</span><span class="p">:</span>
            <span class="n">tmppath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">tmpdirname</span><span class="p">,</span> <span class="s1">&#39;test.nc&#39;</span><span class="p">)</span>
            <span class="n">tncf</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">tmppath</span><span class="p">)</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
            <span class="n">cncf</span> <span class="o">=</span> <span class="n">pncopen</span><span class="p">(</span><span class="n">tmppath</span><span class="p">)</span>
            <span class="n">np_all_close</span><span class="p">(</span><span class="n">to3</span><span class="p">,</span> <span class="n">cncf</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;O3&#39;</span><span class="p">][:])</span>
            <span class="n">sncf</span> <span class="o">=</span> <span class="n">cncf</span><span class="o">.</span><span class="n">subset</span><span class="p">([</span><span class="s1">&#39;O3&#39;</span><span class="p">])</span>
            <span class="n">np_all_close</span><span class="p">(</span><span class="n">to3</span><span class="p">,</span> <span class="n">sncf</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;O3&#39;</span><span class="p">][:])</span>
            <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">tmppath</span><span class="p">)</span></div>


<div class="viewcode-block" id="PseudoNetCDFFileTest.testNcattrs">
<a class="viewcode-back" href="../../../api/PseudoNetCDF.test.html#PseudoNetCDF.test.test_core.PseudoNetCDFFileTest.testNcattrs">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">testNcattrs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">tncf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">testncf</span>
        <span class="n">tncf</span><span class="o">.</span><span class="n">ncattrs</span><span class="p">()</span></div>


<div class="viewcode-block" id="PseudoNetCDFFileTest.testSetncattr">
<a class="viewcode-back" href="../../../api/PseudoNetCDF.test.html#PseudoNetCDF.test.test_core.PseudoNetCDFFileTest.testSetncattr">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">testSetncattr</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">tncf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">testncf</span>
        <span class="n">tncf</span><span class="o">.</span><span class="n">setncattr</span><span class="p">(</span><span class="s1">&#39;test&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">tncf</span><span class="o">.</span><span class="n">test</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span></div>


<div class="viewcode-block" id="PseudoNetCDFFileTest.testDelncattr">
<a class="viewcode-back" href="../../../api/PseudoNetCDF.test.html#PseudoNetCDF.test.test_core.PseudoNetCDFFileTest.testDelncattr">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">testDelncattr</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">tncf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">testncf</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">tncf</span><span class="o">.</span><span class="n">setncattr</span><span class="p">(</span><span class="s1">&#39;test&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">tncf</span><span class="o">.</span><span class="n">delncattr</span><span class="p">(</span><span class="s1">&#39;test&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">tncf</span><span class="p">,</span> <span class="s1">&#39;test&#39;</span><span class="p">))</span></div>


<div class="viewcode-block" id="PseudoNetCDFFileTest.testInsertDimension">
<a class="viewcode-back" href="../../../api/PseudoNetCDF.test.html#PseudoNetCDF.test.test_core.PseudoNetCDFFileTest.testInsertDimension">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">testInsertDimension</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">tncf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">testncf</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">nncf</span> <span class="o">=</span> <span class="n">tncf</span><span class="o">.</span><span class="n">insertDimension</span><span class="p">(</span><span class="n">TEST</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">before</span><span class="o">=</span><span class="s1">&#39;LAY&#39;</span><span class="p">)</span>
        <span class="n">checkv</span> <span class="o">=</span> <span class="p">(</span><span class="n">nncf</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;O3&#39;</span><span class="p">][:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">nncf</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;O3&#39;</span><span class="p">][:,</span> <span class="mi">1</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">checkv</span><span class="o">.</span><span class="n">all</span><span class="p">())</span>
        <span class="n">nncf</span> <span class="o">=</span> <span class="n">tncf</span><span class="o">.</span><span class="n">insertDimension</span><span class="p">(</span><span class="n">TEST</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">checkv</span> <span class="o">=</span> <span class="p">(</span><span class="n">nncf</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;O3&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span> <span class="o">==</span> <span class="n">nncf</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;O3&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">,</span> <span class="p">:])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">checkv</span><span class="o">.</span><span class="n">all</span><span class="p">())</span></div>


<div class="viewcode-block" id="PseudoNetCDFFileTest.testInterpDimension">
<a class="viewcode-back" href="../../../api/PseudoNetCDF.test.html#PseudoNetCDF.test.test_core.PseudoNetCDFFileTest.testInterpDimension">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">testInterpDimension</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">f1</span> <span class="o">=</span> <span class="n">PseudoNetCDFFile</span><span class="p">()</span>
        <span class="n">f1</span><span class="o">.</span><span class="n">createDimension</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">f1</span><span class="o">.</span><span class="n">createDimension</span><span class="p">(</span><span class="s1">&#39;layer&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
        <span class="n">f1</span><span class="o">.</span><span class="n">createDimension</span><span class="p">(</span><span class="s1">&#39;latitude&#39;</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
        <span class="n">f1</span><span class="o">.</span><span class="n">createDimension</span><span class="p">(</span><span class="s1">&#39;longitude&#39;</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
        <span class="n">lay</span> <span class="o">=</span> <span class="n">f1</span><span class="o">.</span><span class="n">createVariable</span><span class="p">(</span><span class="s1">&#39;layer&#39;</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;layer&#39;</span><span class="p">,))</span>
        <span class="n">lay</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
        <span class="n">simple</span> <span class="o">=</span> <span class="n">f1</span><span class="o">.</span><span class="n">createVariable</span><span class="p">(</span>
            <span class="s1">&#39;simple&#39;</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="s1">&#39;layer&#39;</span><span class="p">,</span> <span class="s1">&#39;latitude&#39;</span><span class="p">,</span> <span class="s1">&#39;longitude&#39;</span><span class="p">))</span>
        <span class="n">simple</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">3</span> <span class="o">*</span> <span class="mi">4</span> <span class="o">*</span> <span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
        <span class="n">simple</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">3</span> <span class="o">*</span> <span class="mi">4</span> <span class="o">*</span> <span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>

        <span class="n">f2</span> <span class="o">=</span> <span class="n">f1</span><span class="o">.</span><span class="n">applyAlongDimensions</span><span class="p">(</span><span class="n">layer</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">+</span> <span class="n">x</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">*</span> <span class="mf">.5</span><span class="p">)</span>
        <span class="n">f3</span> <span class="o">=</span> <span class="n">f1</span><span class="o">.</span><span class="n">interpDimension</span><span class="p">(</span><span class="s1">&#39;layer&#39;</span><span class="p">,</span> <span class="n">f2</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;layer&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span>
            <span class="n">f2</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;simple&#39;</span><span class="p">][:],</span> <span class="n">f3</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;simple&#39;</span><span class="p">][:]))</span>
        <span class="n">f4</span> <span class="o">=</span> <span class="n">PseudoNetCDFFile</span><span class="p">()</span>
        <span class="n">f4</span><span class="o">.</span><span class="n">createDimension</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">f4</span><span class="o">.</span><span class="n">createDimension</span><span class="p">(</span><span class="s1">&#39;layer&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
        <span class="n">f4</span><span class="o">.</span><span class="n">createDimension</span><span class="p">(</span><span class="s1">&#39;latitude&#39;</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
        <span class="n">f4</span><span class="o">.</span><span class="n">createDimension</span><span class="p">(</span><span class="s1">&#39;longitude&#39;</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
        <span class="n">lay</span> <span class="o">=</span> <span class="n">f4</span><span class="o">.</span><span class="n">createVariable</span><span class="p">(</span>
            <span class="s1">&#39;layer&#39;</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="s1">&#39;layer&#39;</span><span class="p">,</span> <span class="s1">&#39;latitude&#39;</span><span class="p">,</span> <span class="s1">&#39;longitude&#39;</span><span class="p">))</span>
        <span class="n">lay</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">)[</span><span class="kc">None</span><span class="p">,</span> <span class="p">:,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span>
        <span class="n">simple</span> <span class="o">=</span> <span class="n">f4</span><span class="o">.</span><span class="n">createVariable</span><span class="p">(</span>
            <span class="s1">&#39;simple&#39;</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="s1">&#39;layer&#39;</span><span class="p">,</span> <span class="s1">&#39;latitude&#39;</span><span class="p">,</span> <span class="s1">&#39;longitude&#39;</span><span class="p">))</span>
        <span class="n">simple</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">3</span> <span class="o">*</span> <span class="mi">4</span> <span class="o">*</span> <span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
        <span class="n">simple</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">3</span> <span class="o">*</span> <span class="mi">4</span> <span class="o">*</span> <span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>

        <span class="n">f5</span> <span class="o">=</span> <span class="n">f4</span><span class="o">.</span><span class="n">applyAlongDimensions</span><span class="p">(</span><span class="n">layer</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">+</span> <span class="n">x</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">*</span> <span class="mf">.5</span><span class="p">)</span>
        <span class="n">lay</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">.25</span>
        <span class="n">f6</span> <span class="o">=</span> <span class="n">f4</span><span class="o">.</span><span class="n">interpDimension</span><span class="p">(</span><span class="s1">&#39;layer&#39;</span><span class="p">,</span> <span class="n">f5</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;layer&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span>
            <span class="n">f5</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;simple&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">f6</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;simple&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span>
            <span class="n">f5</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;simple&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">f6</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;simple&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]))</span></div>


<div class="viewcode-block" id="PseudoNetCDFFileTest.testNetCDFFileNew">
<a class="viewcode-back" href="../../../api/PseudoNetCDF.test.html#PseudoNetCDF.test.test_core.PseudoNetCDFFileTest.testNetCDFFileNew">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">testNetCDFFileNew</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">PseudoNetCDFFile</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="n">PseudoNetCDFFile</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">variables</span><span class="p">,</span> <span class="p">{})</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">dimensions</span><span class="p">,</span> <span class="p">{})</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">ncattrs</span><span class="p">(),</span> <span class="p">())</span></div>


<div class="viewcode-block" id="PseudoNetCDFFileTest.testNetCDFFileInit">
<a class="viewcode-back" href="../../../api/PseudoNetCDF.test.html#PseudoNetCDF.test.test_core.PseudoNetCDFFileTest.testNetCDFFileInit">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">testNetCDFFileInit</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="kn">import</span> <span class="n">arange</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_makencf</span><span class="p">()</span>
        <span class="n">tncf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">testncf</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">tncf</span><span class="o">.</span><span class="n">dimensions</span><span class="p">[</span><span class="s1">&#39;TSTEP&#39;</span><span class="p">]),</span> <span class="mi">24</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">tncf</span><span class="o">.</span><span class="n">dimensions</span><span class="p">[</span><span class="s1">&#39;LAY&#39;</span><span class="p">]),</span> <span class="mi">4</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">tncf</span><span class="o">.</span><span class="n">dimensions</span><span class="p">[</span><span class="s1">&#39;ROW&#39;</span><span class="p">]),</span> <span class="mi">5</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">tncf</span><span class="o">.</span><span class="n">dimensions</span><span class="p">[</span><span class="s1">&#39;COL&#39;</span><span class="p">]),</span> <span class="mi">6</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">tncf</span><span class="o">.</span><span class="n">dimensions</span><span class="p">[</span><span class="s1">&#39;nv&#39;</span><span class="p">]),</span> <span class="mi">4</span><span class="p">)</span>

        <span class="n">tncf</span><span class="o">.</span><span class="n">fish</span> <span class="o">=</span> <span class="mi">2</span>
        <span class="nb">setattr</span><span class="p">(</span><span class="n">tncf</span><span class="p">,</span> <span class="s1">&#39;FROG-DOG&#39;</span><span class="p">,</span> <span class="s1">&#39;HAPPY&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">tncf</span><span class="o">.</span><span class="n">variables</span><span class="o">.</span><span class="n">keys</span><span class="p">()),</span> <span class="bp">self</span><span class="o">.</span><span class="n">myvars</span><span class="p">)</span>
        <span class="n">o3</span> <span class="o">=</span> <span class="n">tncf</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;O3&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span>
            <span class="kc">True</span><span class="p">,</span> <span class="p">(</span><span class="n">o3</span> <span class="o">==</span> <span class="n">arange</span><span class="p">(</span><span class="mi">24</span> <span class="o">*</span> <span class="mi">4</span> <span class="o">*</span> <span class="mi">5</span> <span class="o">*</span> <span class="mi">6</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">24</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span><span class="o">.</span><span class="n">all</span><span class="p">())</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">o3</span><span class="o">.</span><span class="n">typecode</span><span class="p">(),</span> <span class="s1">&#39;f&#39;</span><span class="p">)</span>

        <span class="n">filedims</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">tncf</span><span class="o">.</span><span class="n">dimensions</span><span class="p">)</span>
        <span class="n">filedims</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="n">vardims</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">o3</span><span class="o">.</span><span class="n">dimensions</span><span class="p">)</span>
        <span class="n">vardims</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="n">filedims</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s1">&#39;nv&#39;</span><span class="p">)</span>
        <span class="n">filedims</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s1">&#39;tnv&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">filedims</span><span class="p">,</span> <span class="n">vardims</span><span class="p">)</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">PseudoNetCDF.pncgen</span><span class="w"> </span><span class="kn">import</span> <span class="n">Pseudo2NetCDF</span>
        <span class="n">n</span> <span class="o">=</span> <span class="n">Pseudo2NetCDF</span><span class="p">()</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="n">tncf</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">n</span><span class="o">.</span><span class="n">variables</span><span class="o">.</span><span class="n">keys</span><span class="p">()),</span> <span class="bp">self</span><span class="o">.</span><span class="n">myvars</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span>
            <span class="nb">dict</span><span class="p">([(</span><span class="n">k</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">))</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">n</span><span class="o">.</span><span class="n">dimensions</span><span class="o">.</span><span class="n">items</span><span class="p">()]),</span>
            <span class="nb">dict</span><span class="p">([(</span><span class="n">k</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">))</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">testncf</span><span class="o">.</span><span class="n">dimensions</span><span class="o">.</span><span class="n">items</span><span class="p">()])</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span>
            <span class="kc">True</span><span class="p">,</span> <span class="p">(</span><span class="n">n</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;O3&#39;</span><span class="p">][</span><span class="o">...</span><span class="p">]</span> <span class="o">==</span> <span class="n">tncf</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;O3&#39;</span><span class="p">][</span><span class="o">...</span><span class="p">])</span><span class="o">.</span><span class="n">all</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">n</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;O3&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">units</span><span class="p">,</span> <span class="s1">&#39;ppbv&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">n</span><span class="o">.</span><span class="n">fish</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="s1">&#39;FROG-DOG&#39;</span><span class="p">),</span> <span class="s1">&#39;HAPPY&#39;</span><span class="p">)</span></div>


<div class="viewcode-block" id="PseudoNetCDFFileTest.testNetCDFVariables">
<a class="viewcode-back" href="../../../api/PseudoNetCDF.test.html#PseudoNetCDF.test.test_core.PseudoNetCDFFileTest.testNetCDFVariables">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">testNetCDFVariables</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="kn">import</span> <span class="n">arange</span>
        <span class="n">tncf</span> <span class="o">=</span> <span class="n">PseudoNetCDFFile</span><span class="p">()</span>
        <span class="n">tncf</span><span class="o">.</span><span class="n">createDimension</span><span class="p">(</span><span class="s1">&#39;TSTEP&#39;</span><span class="p">,</span> <span class="mi">24</span><span class="p">)</span>
        <span class="n">tncf</span><span class="o">.</span><span class="n">createDimension</span><span class="p">(</span><span class="s1">&#39;LAY&#39;</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
        <span class="n">tncf</span><span class="o">.</span><span class="n">createDimension</span><span class="p">(</span><span class="s1">&#39;ROW&#39;</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
        <span class="n">tncf</span><span class="o">.</span><span class="n">createDimension</span><span class="p">(</span><span class="s1">&#39;COL&#39;</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>

        <span class="k">def</span><span class="w"> </span><span class="nf">const</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwds</span><span class="p">):</span>
            <span class="n">vals</span> <span class="o">=</span> <span class="n">arange</span><span class="p">(</span><span class="mi">24</span> <span class="o">*</span> <span class="mi">4</span> <span class="o">*</span> <span class="mi">5</span> <span class="o">*</span> <span class="mi">6</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">24</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
            <span class="n">dims</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;TSTEP&#39;</span><span class="p">,</span> <span class="s1">&#39;LAY&#39;</span><span class="p">,</span> <span class="s1">&#39;ROW&#39;</span><span class="p">,</span> <span class="s1">&#39;COL&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">PseudoNetCDFVariable</span><span class="p">(</span><span class="n">tncf</span><span class="p">,</span> <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="n">dims</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="n">vals</span><span class="p">)</span>
        <span class="n">tncf</span><span class="o">.</span><span class="n">variables</span> <span class="o">=</span> <span class="n">PseudoNetCDFVariables</span><span class="p">(</span><span class="n">const</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;NO&#39;</span><span class="p">,</span> <span class="s1">&#39;O3&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="p">(</span><span class="n">tncf</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;O3&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">arange</span><span class="p">(</span>
            <span class="mi">24</span> <span class="o">*</span> <span class="mi">4</span> <span class="o">*</span> <span class="mi">5</span> <span class="o">*</span> <span class="mi">6</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">24</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span><span class="o">.</span><span class="n">all</span><span class="p">())</span></div>


<div class="viewcode-block" id="PseudoNetCDFFileTest.testFromArrays">
<a class="viewcode-back" href="../../../api/PseudoNetCDF.test.html#PseudoNetCDF.test.test_core.PseudoNetCDFFileTest.testFromArrays">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">testFromArrays</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">var</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">testncf</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;O3&#39;</span><span class="p">]</span>
        <span class="n">arr</span> <span class="o">=</span> <span class="n">var</span><span class="o">.</span><span class="n">array</span><span class="p">()</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">checkncf</span> <span class="o">=</span> <span class="n">PseudoNetCDFFile</span><span class="o">.</span><span class="n">from_arrays</span><span class="p">(</span>
            <span class="n">dims</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;TSTEP&#39;</span><span class="p">,</span> <span class="s1">&#39;LAY&#39;</span><span class="p">,</span> <span class="s1">&#39;ROW&#39;</span><span class="p">,</span> <span class="s1">&#39;COL&#39;</span><span class="p">),</span> <span class="n">fileattrs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span>
            <span class="o">**</span><span class="p">{</span><span class="s1">&#39;O3&#39;</span><span class="p">:</span> <span class="n">arr</span><span class="p">},</span> <span class="n">nameattr</span><span class="o">=</span><span class="s1">&#39;long_name&#39;</span>
        <span class="p">)</span>
        <span class="n">checkvar</span> <span class="o">=</span> <span class="n">checkncf</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;O3&#39;</span><span class="p">]</span>
        <span class="n">np_all_close</span><span class="p">(</span>
            <span class="n">checkvar</span><span class="p">[:],</span> <span class="n">var</span><span class="p">[:]</span>
        <span class="p">)</span>
        <span class="k">assert</span> <span class="p">(</span><span class="n">checkvar</span><span class="o">.</span><span class="n">getncattr</span><span class="p">(</span><span class="s1">&#39;long_name&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;O3&#39;</span><span class="p">)</span>
        <span class="k">assert</span> <span class="p">(</span><span class="n">checkncf</span><span class="o">.</span><span class="n">a</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span></div>


<div class="viewcode-block" id="PseudoNetCDFFileTest.testMask">
<a class="viewcode-back" href="../../../api/PseudoNetCDF.test.html#PseudoNetCDF.test.test_core.PseudoNetCDFFileTest.testMask">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">testMask</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">o3</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">testncf</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;O3&#39;</span><span class="p">][:]</span>
        <span class="c1"># median is the average of 1439 and 1440</span>
        <span class="c1"># 1439.5, so masks half. Using 1440</span>
        <span class="n">median</span> <span class="o">=</span> <span class="mi">1440</span>
        <span class="n">chkf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">testncf</span><span class="o">.</span><span class="n">mask</span><span class="p">(</span><span class="n">less</span><span class="o">=</span><span class="n">median</span><span class="p">)</span>
        <span class="k">assert</span> <span class="p">(</span><span class="n">chkf</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;O3&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mask</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">==</span> <span class="mi">1440</span><span class="p">)</span>
        <span class="n">chkf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">testncf</span><span class="o">.</span><span class="n">mask</span><span class="p">(</span><span class="n">less_equal</span><span class="o">=</span><span class="n">median</span><span class="p">)</span>
        <span class="k">assert</span> <span class="p">(</span><span class="n">chkf</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;O3&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mask</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">==</span> <span class="mi">1441</span><span class="p">)</span>
        <span class="n">chkf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">testncf</span><span class="o">.</span><span class="n">mask</span><span class="p">(</span><span class="n">where</span><span class="o">=</span><span class="n">o3</span> <span class="o">&lt;</span> <span class="n">median</span><span class="p">)</span>
        <span class="k">assert</span> <span class="p">(</span><span class="n">chkf</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;O3&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mask</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">==</span> <span class="mi">1440</span><span class="p">)</span>
        <span class="n">chkf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">testncf</span><span class="o">.</span><span class="n">mask</span><span class="p">(</span><span class="n">greater</span><span class="o">=</span><span class="n">median</span><span class="p">)</span>
        <span class="k">assert</span> <span class="p">(</span><span class="n">chkf</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;O3&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mask</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">==</span> <span class="mi">1439</span><span class="p">)</span>
        <span class="n">chkf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">testncf</span><span class="o">.</span><span class="n">mask</span><span class="p">(</span><span class="n">greater_equal</span><span class="o">=</span><span class="n">median</span><span class="p">)</span>
        <span class="k">assert</span> <span class="p">(</span><span class="n">chkf</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;O3&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mask</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">==</span> <span class="mi">1440</span><span class="p">)</span></div>


<div class="viewcode-block" id="PseudoNetCDFFileTest.testIsMine">
<a class="viewcode-back" href="../../../api/PseudoNetCDF.test.html#PseudoNetCDF.test.test_core.PseudoNetCDFFileTest.testIsMine">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">testIsMine</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="kn">import</span><span class="w"> </span><span class="nn">tempfile</span>
        <span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">..</span><span class="w"> </span><span class="kn">import</span> <span class="n">PseudoNetCDFFile</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">..core</span><span class="w"> </span><span class="kn">import</span> <span class="n">netcdf</span>
        <span class="n">tncf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">testncf</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="k">with</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">TemporaryDirectory</span><span class="p">()</span> <span class="k">as</span> <span class="n">tmpdirname</span><span class="p">:</span>
            <span class="n">tmppath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">tmpdirname</span><span class="p">,</span> <span class="s1">&#39;test.nc&#39;</span><span class="p">)</span>
            <span class="n">tncf</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">tmppath</span><span class="p">)</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
            <span class="k">assert</span> <span class="o">~</span><span class="n">PseudoNetCDFFile</span><span class="o">.</span><span class="n">isMine</span><span class="p">(</span><span class="n">tmppath</span><span class="p">)</span>
            <span class="k">assert</span> <span class="n">netcdf</span><span class="o">.</span><span class="n">isMine</span><span class="p">(</span><span class="n">tmppath</span><span class="p">)</span>
            <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">tmppath</span><span class="p">)</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">tmppath</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">dummy</span><span class="p">:</span>
                <span class="n">dummy</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;hi&#39;</span><span class="p">)</span>
            <span class="k">assert</span> <span class="o">~</span><span class="n">netcdf</span><span class="o">.</span><span class="n">isMine</span><span class="p">(</span><span class="n">tmppath</span><span class="p">)</span>
            <span class="k">assert</span> <span class="o">~</span><span class="n">PseudoNetCDFFile</span><span class="o">.</span><span class="n">isMine</span><span class="p">(</span><span class="n">tmppath</span><span class="p">)</span>
            <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">tmppath</span><span class="p">)</span></div>


<div class="viewcode-block" id="PseudoNetCDFFileTest.testFromNCF">
<a class="viewcode-back" href="../../../api/PseudoNetCDF.test.html#PseudoNetCDF.test.test_core.PseudoNetCDFFileTest.testFromNCF">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">testFromNCF</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">..</span><span class="w"> </span><span class="kn">import</span> <span class="n">PseudoNetCDFFile</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">..core</span><span class="w"> </span><span class="kn">import</span> <span class="n">netcdf</span>

        <span class="n">chkncf</span> <span class="o">=</span> <span class="n">PseudoNetCDFFile</span><span class="o">.</span><span class="n">from_ncf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">testncf</span><span class="p">)</span>
        <span class="n">compare_files</span><span class="p">(</span><span class="n">chkncf</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">testncf</span><span class="p">)</span>
        <span class="n">chkncf</span> <span class="o">=</span> <span class="n">netcdf</span><span class="o">.</span><span class="n">from_ncf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">testncf</span><span class="p">)</span>
        <span class="n">compare_files</span><span class="p">(</span><span class="n">chkncf</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">testncf</span><span class="p">)</span></div>


<div class="viewcode-block" id="PseudoNetCDFFileTest.testNetcdf">
<a class="viewcode-back" href="../../../api/PseudoNetCDF.test.html#PseudoNetCDF.test.test_core.PseudoNetCDFFileTest.testNetcdf">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">testNetcdf</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="kn">import</span><span class="w"> </span><span class="nn">tempfile</span>
        <span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">..core</span><span class="w"> </span><span class="kn">import</span> <span class="n">netcdf</span>
        <span class="n">tncf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">testncf</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="k">with</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">TemporaryDirectory</span><span class="p">()</span> <span class="k">as</span> <span class="n">tmpdirname</span><span class="p">:</span>
            <span class="n">tmppath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">tmpdirname</span><span class="p">,</span> <span class="s1">&#39;test.nc&#39;</span><span class="p">)</span>
            <span class="n">cncf</span> <span class="o">=</span> <span class="n">netcdf</span><span class="p">(</span><span class="n">tmppath</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
            <span class="n">cncf</span><span class="o">.</span><span class="n">setncatts</span><span class="p">(</span><span class="n">tncf</span><span class="o">.</span><span class="n">getncatts</span><span class="p">())</span>
            <span class="k">for</span> <span class="n">dk</span><span class="p">,</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">tncf</span><span class="o">.</span><span class="n">dimensions</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">cncf</span><span class="o">.</span><span class="n">copyDimension</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">dk</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">vk</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">tncf</span><span class="o">.</span><span class="n">variables</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">cncf</span><span class="o">.</span><span class="n">copyVariable</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">vk</span><span class="p">)</span>
            <span class="n">compare_files</span><span class="p">(</span><span class="n">tncf</span><span class="p">,</span> <span class="n">cncf</span><span class="p">)</span>
            <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">tmppath</span><span class="p">)</span></div>


<div class="viewcode-block" id="PseudoNetCDFFileTest.testOpenMFDataset">
<a class="viewcode-back" href="../../../api/PseudoNetCDF.test.html#PseudoNetCDF.test.test_core.PseudoNetCDFFileTest.testOpenMFDataset">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">testOpenMFDataset</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="kn">import</span><span class="w"> </span><span class="nn">tempfile</span>
        <span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">..core</span><span class="w"> </span><span class="kn">import</span> <span class="n">netcdf</span>
        <span class="n">tncf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">testncf</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">to3</span> <span class="o">=</span> <span class="n">tncf</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;O3&#39;</span><span class="p">][:]</span>
        <span class="k">with</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">TemporaryDirectory</span><span class="p">()</span> <span class="k">as</span> <span class="n">tmpdirname</span><span class="p">:</span>
            <span class="n">tmppath1</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">tmpdirname</span><span class="p">,</span> <span class="s1">&#39;test1.nc&#39;</span><span class="p">)</span>
            <span class="n">tmppath2</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">tmpdirname</span><span class="p">,</span> <span class="s1">&#39;test2.nc&#39;</span><span class="p">)</span>
            <span class="n">tncf</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">tmppath1</span><span class="p">)</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
            <span class="n">tncf</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">tmppath2</span><span class="p">)</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
            <span class="n">nt</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">tncf</span><span class="o">.</span><span class="n">dimensions</span><span class="p">[</span><span class="s1">&#39;TSTEP&#39;</span><span class="p">])</span>
            <span class="n">cncf</span> <span class="o">=</span> <span class="n">netcdf</span><span class="o">.</span><span class="n">open_mfdataset</span><span class="p">(</span><span class="n">tmppath1</span><span class="p">,</span> <span class="n">tmppath2</span><span class="p">,</span> <span class="n">stackdim</span><span class="o">=</span><span class="s1">&#39;TSTEP&#39;</span><span class="p">)</span>
            <span class="n">np_all_close</span><span class="p">(</span><span class="n">cncf</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;O3&#39;</span><span class="p">][:</span><span class="n">nt</span><span class="p">],</span> <span class="n">to3</span><span class="p">)</span>
            <span class="n">np_all_close</span><span class="p">(</span><span class="n">cncf</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;O3&#39;</span><span class="p">][</span><span class="n">nt</span><span class="p">:],</span> <span class="n">to3</span><span class="p">)</span>
            <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">tmppath1</span><span class="p">)</span>
            <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">tmppath2</span><span class="p">)</span></div>


<div class="viewcode-block" id="PseudoNetCDFFileTest.runTest">
<a class="viewcode-back" href="../../../api/PseudoNetCDF.test.html#PseudoNetCDF.test.test_core.PseudoNetCDFFileTest.runTest">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">runTest</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">pass</span></div>
</div>

</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2018, Barron H. Henderson.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>